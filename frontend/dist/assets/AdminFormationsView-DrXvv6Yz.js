import{j as e}from"./ui-B5ZVMT00.js";import{b as t,r,u as a,L as o}from"./router-Cgxi-4fo.js";import{u as s,aP as n,K as l,B as i,L as c,m as d,o as m,av as u,ao as h,ba as x,j as p,au as f,M as g,c as v,C as b,D as y,k as j,H as k,l as w,n as C,I as N}from"./index-B55PlCdI.js";import{A as P,a as O,b as A}from"./alert-C5A0QBqW.js";import{T as S}from"./trash-2-DMRirc8R.js";import{T as D}from"./triangle-alert-edurVSPy.js";import F from"./FormationTable-CK-2hSxM.js";import"./react-0RZ2pslC.js";import"./query-DUefEkVx.js";import"./charts-D4j3G6dB.js";import"./table-BOfc4hnL.js";import"./pencil-CRuN9T9r.js";function E(e,t){if(null==e)return{};var r,a,o=function(e,t){if(null==e)return{};var r,a,o={},s=Object.keys(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function z(){return z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},z.apply(this,arguments)}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(Object(r),!0).forEach((function(t){T(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function T(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const q={breakpointCols:void 0,className:void 0,columnClassName:void 0,children:void 0,columnAttrs:void 0,column:void 0};class W extends t.Component{constructor(e){let t;super(e),this.reCalculateColumnCount=this.reCalculateColumnCount.bind(this),this.reCalculateColumnCountDebounce=this.reCalculateColumnCountDebounce.bind(this),t=this.props.breakpointCols&&this.props.breakpointCols.default?this.props.breakpointCols.default:parseInt(this.props.breakpointCols)||2,this.state={columnCount:t}}componentDidMount(){this.reCalculateColumnCount(),window&&window.addEventListener("resize",this.reCalculateColumnCountDebounce)}componentDidUpdate(){this.reCalculateColumnCount()}componentWillUnmount(){window&&window.removeEventListener("resize",this.reCalculateColumnCountDebounce)}reCalculateColumnCountDebounce(){window&&window.requestAnimationFrame?(window.cancelAnimationFrame&&window.cancelAnimationFrame(this._lastRecalculateAnimationFrame),this._lastRecalculateAnimationFrame=window.requestAnimationFrame((()=>{this.reCalculateColumnCount()}))):this.reCalculateColumnCount()}reCalculateColumnCount(){const e=window&&window.innerWidth||1/0;let t=this.props.breakpointCols;"object"!=typeof t&&(t={default:parseInt(t)||2});let r=1/0,a=t.default||2;for(let o in t){const s=parseInt(o);s>0&&e<=s&&s<r&&(r=s,a=t[o])}a=Math.max(1,parseInt(a)||1),this.state.columnCount!==a&&this.setState({columnCount:a})}itemsInColumns(){const e=this.state.columnCount,r=new Array(e),a=t.Children.toArray(this.props.children);for(let t=0;t<a.length;t++){const o=t%e;r[o]||(r[o]=[]),r[o].push(a[t])}return r}renderColumns(){const{column:e,columnAttrs:r={},columnClassName:a}=this.props,o=this.itemsInColumns(),s=100/o.length+"%";let n=a;n&&"string"!=typeof n&&(this.logDeprecated('The property "columnClassName" requires a string'),void 0===n&&(n="my-masonry-grid_column"));const l=L(L(L({},e),r),{},{style:L(L({},r.style),{},{width:s}),className:n});return o.map(((e,r)=>t.createElement("div",z({},l,{key:r}),e)))}logDeprecated(e){console.error("[Masonry]",e)}render(){const e=this.props,{children:r,breakpointCols:a,columnClassName:o,columnAttrs:s,column:n,className:l}=e,i=E(e,["children","breakpointCols","columnClassName","columnAttrs","column","className"]);let c=l;return"string"!=typeof l&&(this.logDeprecated('The property "className" requires a string'),void 0===l&&(c="my-masonry-grid")),t.createElement("div",z({},i,{className:c}),this.renderColumns())}}function $(){const[t,F]=r.useState([]),[E,z]=r.useState(!0),[I,L]=r.useState(""),[T,q]=r.useState(null),[W,$]=r.useState({currentPage:1,totalPages:1,limit:9,total:0}),M=r.useRef(null),R=a();s();const[_,B]=r.useState(null),[H,U]=r.useState(!1),[J,K]=r.useState(null),[V,G]=r.useState(!1);r.useEffect((()=>{const e=setTimeout((()=>{$((e=>({...e,currentPage:1}))),Q(1)}),300);return()=>clearTimeout(e)}),[I]),r.useEffect((()=>{Q(W.currentPage)}),[W.currentPage]);const Q=async(e=1)=>{z(!0),q(null);try{const t=await n.getAllFormations(e,W.limit,I);F(t.formations),$(t.pagination||{currentPage:e,totalPages:1,limit:W.limit,total:t.formations.length})}catch(t){F([]),q("Erreur lors du chargement des formations.")}finally{z(!1)}},X=e=>{e>=1&&e<=W.totalPages&&$((t=>({...t,currentPage:e})))},Y={"Développement Web":"bg-gradient-to-r from-amber-100 via-yellow-100 to-orange-100 dark:from-amber-900 dark:via-yellow-900 dark:to-orange-900 text-amber-800 dark:text-amber-200 hover:from-amber-200 hover:via-yellow-200 hover:to-orange-200 dark:hover:from-amber-800 dark:hover:via-yellow-800 dark:hover:to-orange-800","Data Science":"bg-gradient-to-r from-blue-100 via-cyan-100 to-teal-100 dark:from-blue-900 dark:via-cyan-900 dark:to-teal-900 text-blue-700 dark:text-blue-300 hover:from-blue-200 hover:via-cyan-200 hover:to-teal-200 dark:hover:from-blue-800 dark:hover:via-cyan-800 dark:hover:to-teal-800","Cybersécurité":"bg-gradient-to-r from-violet-100 via-purple-100 to-fuchsia-100 dark:from-violet-900 dark:via-purple-900 dark:to-fuchsia-900 text-violet-700 dark:text-violet-300 hover:from-violet-200 hover:via-purple-200 hover:to-fuchsia-200 dark:hover:from-violet-800 dark:hover:via-purple-800 dark:hover:to-fuchsia-800",DevOps:"bg-gradient-to-r from-orange-100 via-amber-100 to-yellow-100 dark:from-orange-900 dark:via-amber-900 dark:to-yellow-900 text-orange-700 dark:text-orange-300 hover:from-orange-200 hover:via-amber-200 hover:to-yellow-200 dark:hover:from-orange-800 dark:hover:via-amber-800 dark:hover:to-yellow-800",IA:"bg-gradient-to-r from-indigo-100 via-blue-100 to-sky-100 dark:from-indigo-900 dark:via-blue-900 dark:to-sky-900 text-indigo-700 dark:text-indigo-300 hover:from-indigo-200 hover:via-blue-200 hover:to-sky-200 dark:hover:from-indigo-800 dark:hover:via-blue-800 dark:hover:to-sky-800","Cloud Computing":"bg-gradient-to-r from-sky-100 via-cyan-100 to-blue-100 dark:from-sky-900 dark:via-cyan-900 dark:to-blue-900 text-sky-700 dark:text-sky-300 hover:from-sky-200 hover:via-cyan-200 hover:to-blue-200 dark:hover:from-sky-800 dark:hover:via-cyan-800 dark:hover:to-blue-800",default:"bg-gradient-to-r from-emerald-100 via-teal-100 to-cyan-100 dark:from-emerald-900 dark:via-teal-900 dark:to-cyan-900 text-emerald-700 dark:text-emerald-300 hover:from-emerald-200 hover:via-teal-200 hover:to-cyan-200 dark:hover:from-emerald-800 dark:hover:via-teal-800 dark:hover:to-cyan-800"};return e.jsxs("div",{children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-end items-center mb-10 gap-4",children:e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto justify-end",children:[e.jsxs("div",{className:"relative flex-1 md:flex-initial max-w-[300px]",children:[e.jsx("input",{type:"text",placeholder:"Rechercher une formation...",value:I,onChange:e=>L(e.target.value),ref:M,className:"pl-10 pr-4 py-2 w-full rounded-lg border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 dark:bg-gray-800 dark:border-gray-700 dark:text-white"}),e.jsx(l,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"})]}),e.jsx(o,{to:"/formations/new",children:e.jsx(i,{className:"bg-gradient-to-r from-blue-600 to-cyan-400 text-white shadow-lg hover:from-blue-700 hover:to-cyan-500 transition",children:"Nouvelle Formation"})})]})}),E?e.jsx("div",{className:"flex justify-center items-center py-24",children:e.jsx(c,{className:"animate-spin w-10 h-10 text-blue-300"})}):T?e.jsx("div",{className:"text-center text-red-500 py-8",children:T}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:Array.isArray(t)&&0===t.length?e.jsx("div",{className:"text-center text-gray-300 col-span-2",children:"Aucune formation trouvée."}):Array.isArray(t)&&t.map(((t,r)=>{const a=Array.isArray(t.students)?t.students.length:0,o=t.capacity||0,s=((e,t)=>{const r=e/t*100;return r>=100?{text:"Complet",color:"text-red-500",bgColor:"bg-red-100 dark:bg-red-900/20"}:r>=80?{text:"Presque complet",color:"text-orange-500",bgColor:"bg-orange-100 dark:bg-orange-900/20"}:r>=50?{text:"Places limitées",color:"text-yellow-500",bgColor:"bg-yellow-100 dark:bg-yellow-900/20"}:{text:"Places disponibles",color:"text-green-500",bgColor:"bg-green-100 dark:bg-green-900/20"}})(a,o),n=o>0?Math.min(a/o*100,100):0;return e.jsx(d.div,{initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:.08*r,duration:.6,type:"spring",stiffness:120},whileHover:{scale:1.03,boxShadow:"0 8px 32px 0 rgba(82, 142, 178, 0.10)"},className:"flex",children:e.jsxs(m,{className:"relative rounded-2xl overflow-hidden bg-white border border-gray-200 shadow-md hover:shadow-lg transition-all cursor-pointer group flex flex-col w-full h-[460px]",onClick:()=>{R(`/formations/edit/${t.id}`)},children:[e.jsxs("div",{className:"relative w-full h-48 bg-gray-50 flex items-center justify-center overflow-hidden",children:[e.jsx("img",{src:t.image_url||"/placeholder.svg",alt:t.name,className:"object-cover w-full h-full transition-transform duration-500 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-[#02284f]/90 via-[#02284f]/50 to-transparent z-10 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex items-end justify-center pb-4",children:e.jsx(i,{className:"bg-transparent text-white font-semibold px-6 py-2 rounded-full shadow-none border-none hover:text-blue-200 transition",style:{background:"none",boxShadow:"none"},onClick:e=>{e.stopPropagation(),R(`/formations/edit/${t.id}`)},children:"Voir détails"})})]}),e.jsxs("div",{className:"p-6 z-20 relative flex flex-col flex-1 min-h-0",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-2 items-center justify-between",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(u,{className:`${Y[t.specialization?.name||"default"]} transition-all duration-300 text-xs sm:text-sm`,children:t.specialization?.name||"Formation"}),e.jsx(u,{variant:"outline",className:"bg-gradient-to-r from-amber-50 to-white dark:from-amber-900/20 dark:to-slate-900 border-amber-200 dark:border-amber-700/50 text-xs sm:text-sm",children:t.promotion||"N/A"})]}),e.jsx(i,{variant:"destructive",size:"icon",className:"hover:bg-red-600 hover:text-white transition ml-2",onClick:e=>{e.stopPropagation(),K(t),U(!0)},disabled:_===t.id,title:"Supprimer la formation",children:e.jsx(S,{className:"w-4 h-4"})})]}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-1 line-clamp-2 min-h-[2.5em]",title:t.name,style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.name}),e.jsx("p",{className:"text-gray-700 text-sm mb-3 min-h-[40px] line-clamp-2",title:t.description,style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:t.description||"Aucune description."}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{className:"h-4 w-4 text-[#528eb2]"}),e.jsxs("span",{className:"text-sm font-medium",children:[a," / ",o," étudiants"]})]}),e.jsx(u,{className:`${s.bgColor} ${s.color} text-xs`,children:s.text})]}),e.jsx(x,{value:n,className:"h-2"})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-gray-500 text-xs mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(p,{className:"w-4 h-4 text-[#528eb2]"}),t.dateStart?new Date(t.dateStart).toLocaleDateString():"N/A"]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"w-4 h-4 text-[#528eb2]"}),t.duration?`${t.duration} mois`:"N/A"]}),t.location&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(g,{className:"w-4 h-4 text-[#528eb2]"}),t.location]})]}),t.createdAt&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["Créée le ",new Date(t.createdAt).toLocaleDateString()]})]})]})},t.id)}))}),e.jsxs("div",{className:"mt-4 flex items-center justify-between px-4",children:[e.jsx("div",{className:"flex items-center text-sm text-gray-500 dark:text-gray-400",children:e.jsxs("span",{children:["Page ",W.currentPage," sur ",W.totalPages," (",W.total," formations)"]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>X(W.currentPage-1),disabled:1===W.currentPage,className:"flex items-center gap-1",children:[e.jsx(v,{className:"w-4 h-4"}),"Précédent"]}),e.jsxs(i,{variant:"outline",size:"sm",onClick:()=>X(W.currentPage+1),disabled:W.currentPage>=W.totalPages,className:"flex items-center gap-1",children:["Suivant",e.jsx(b,{className:"w-4 h-4"})]})]})]})]}),e.jsx(y,{open:H,onOpenChange:U,children:e.jsxs(j,{className:"max-h-[calc(100vh-2rem)] w-full max-w-md overflow-hidden rounded-2xl border-0 shadow-xl",children:[e.jsxs(k,{children:[e.jsxs(w,{className:"text-xl font-semibold flex items-center gap-2",children:[e.jsx(D,{className:"h-5 w-5 text-red-600"}),"Confirmation de suppression"]}),e.jsxs(C,{className:"text-base mt-2",children:["Êtes-vous sûr de vouloir supprimer la formation ",e.jsx("b",{children:J?.name})," ? Cette action est irréversible."]})]}),e.jsxs(P,{variant:"destructive",className:"mb-4",children:[e.jsx(O,{children:"Attention"}),e.jsx(A,{children:"Cette action supprimera définitivement la formation et toutes ses données associées. Cette action ne peut pas être annulée."})]}),e.jsxs(N,{className:"mt-6 flex justify-end space-x-2",children:[e.jsx(i,{variant:"outline",onClick:()=>U(!1),disabled:V,className:"rounded-full border-2 hover:bg-gray-100 transition-all duration-200",children:"Annuler"}),e.jsx(i,{variant:"destructive",onClick:async()=>{if(!J)return;G(!0);const e=J.id,r=t,a=t.filter((t=>t.id!==e));F(a),$((e=>({...e,total:e.total-1,currentPage:0===a.length&&e.currentPage>1?e.currentPage-1:e.currentPage})));try{await n.deleteFormation(e),0===a.length&&W.currentPage>1&&Q(W.currentPage-1),U(!1),K(null)}catch(o){F(r),$((e=>({...e,total:e.total+1}))),q(o.message)}finally{G(!1)}},disabled:V,className:"rounded-full bg-gradient-to-r from-red-500 to-red-700 hover:from-red-600 hover:to-red-800 transition-all duration-200",children:V?e.jsxs(e.Fragment,{children:[e.jsx(c,{className:"mr-2 h-4 w-4 animate-spin"}),"Suppression..."]}):"Supprimer définitivement"})]})]})}),e.jsx("style",{children:"\n        .masonry-column {\n          background-clip: padding-box;\n        }\n      "})]})}function M(){const[t,a]=r.useState("cards");return e.jsxs("div",{className:"max-w-7xl mx-auto py-10 px-2 md:px-0",children:[e.jsxs("div",{className:"flex items-center mb-8 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold tracking-tight text-primary drop-shadow",children:"Liste des Formations"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(i,{variant:"cards"===t?"default":"outline",onClick:()=>a("cards"),children:"Cartes"}),e.jsx(i,{variant:"table"===t?"default":"outline",onClick:()=>a("table"),children:"Tableau"})]})]}),"cards"===t?e.jsx($,{}):e.jsx(F,{})]})}W.defaultProps=q;export{M as default};
