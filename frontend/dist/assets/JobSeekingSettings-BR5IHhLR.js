import{j as e,o as t}from"./ui-DiOaG2iA.js";import{r as s,R as a}from"./router-D7BdrHDj.js";import{x as i,w as n,e as r,t as c,B as o,S as l,a9 as d,a6 as h,W as u,D as m,j as f,G as p,k as x,l as g,H as b,aa as y,m as v,ab as j,R as w,ac as N,N as k}from"./index-BpIDiI3H.js";import{I as C}from"./input-DTRl3xjQ.js";import{P as S}from"./phone-input-CPCYzAB1.js";import{L as E}from"./label-D1xi6yHi.js";import{L as A}from"./loader-circle-DaAXFGut.js";import{D}from"./download-Ck1mA0HZ.js";import{T as R}from"./trash-2-cQ66JA2A.js";import{F as U}from"./file-DOZplnh7.js";import{C as P}from"./circle-alert-e-A8qJUH.js";import{S as I}from"./switch-CZWMmMQe.js";
/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=i("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),z=i("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const F=new class{constructor(){this.cache={notifications:{notifications:[],pagination:{total:0,page:1,limit:10,pages:1},unread_count:0},unreadCount:0,lastFetch:null,fetchPromise:null},this.subscribers=[],this.pollingInterval=null,this.pollingDelay=6e4,this.useMockBackend=!1}async getNotifications(e=1,t=10,s=!0,a=!1){try{if(this.useMockBackend&&(console.log("Using mock notifications data (backend unavailable)"),await new Promise((e=>setTimeout(e,300))),this.cache.notifications&&this.cache.notifications.notifications)){let a=[...this.cache.notifications.notifications];s||(a=a.filter((e=>!e.isRead))),a.sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt)));const i=a.length,n=Math.max(1,Math.ceil(i/t)),r=(e-1)*t,c={notifications:a.slice(r,r+t),pagination:{total:i,page:e,limit:t,pages:n},unread_count:a.filter((e=>!e.isRead)).length};return this.cache.notifications=c,this.cache.unreadCount=c.unread_count,this.cache.lastFetch=new Date,this.notifySubscribers(),c}if(this.cache.fetchPromise)try{await this.cache.fetchPromise}catch(i){console.log("Waiting for fetch promise failed, checking cache next")}if(!a&&this.cache.notifications&&this.cache.notifications.notifications)return console.log("Using cached notifications data (immediate response)"),this.cache.notifications;try{console.log("Fetching fresh notifications data from API"),this.cache.fetchPromise=n.get(`/api/notifications?page=${e}&limit=${t}&include_read=${s}`);const a=await this.cache.fetchPromise;return this.cache.notifications=a.data,this.cache.unreadCount=a.data.unread_count||0,this.cache.lastFetch=new Date,this.notifySubscribers(),this.cache.fetchPromise=null,a.data}catch(i){if(console.log("Using cached notifications data due to API error"),this.cache.notifications&&this.cache.notifications.notifications)return console.log("Returning cached notification data due to API error"),this.cache.fetchPromise=null,this.cache.notifications;const e={notifications:[],pagination:{total:0,page:1,limit:10,pages:1},unread_count:0};return this.cache.notifications=e,this.cache.unreadCount=0,this.cache.lastFetch=new Date,this.notifySubscribers(),this.cache.fetchPromise=null,e}}catch(i){return this.cache.fetchPromise=null,console.error("Error fetching notifications:",i),this.cache.notifications&&this.cache.notifications.notifications?(console.log("Returning cached notification data in catch block"),this.cache.notifications):{notifications:[],pagination:{total:0,page:1,limit:10,pages:1},unread_count:0}}}async getUnreadCount(e=!1){try{if(e){let e=0;this.cache.notifications&&this.cache.notifications.notifications&&(e=this.cache.notifications.notifications.filter((e=>!e.readAt&&!e.isRead)).length,this.cache.unreadCount=e,this.notifySubscribers())}if(!e&&this.cache.lastFetch){const e=new Date;if(e-this.cache.lastFetch<3e4)return this.cache.unreadCount}let t=0;return this.cache.notifications&&this.cache.notifications.notifications&&(t=this.cache.notifications.notifications.filter((e=>!e.readAt&&!e.isRead)).length),this.cache.unreadCount=t,this.cache.lastFetch=new Date,this.notifySubscribers(),t}catch(t){return console.error("Error calculating unread notification count:",t),0}}markNotificationAsReadLocally(e){if(!this.cache.notifications||!this.cache.notifications.notifications)return!1;const t=this.cache.notifications.notifications.find((t=>t.id===e));return!(!t||t.readAt)&&(t.readAt=(new Date).toISOString(),t.isRead=!0,this.cache.unreadCount=Math.max(0,this.cache.unreadCount-1),this.notifySubscribers(),!0)}markAllNotificationsAsReadLocally(){if(!this.cache.notifications||!this.cache.notifications.notifications)return!1;let e=!1;return this.cache.notifications.notifications.forEach((t=>{t.readAt||(t.readAt=(new Date).toISOString(),t.isRead=!0,e=!0)})),e&&(this.cache.unreadCount=0,this.notifySubscribers()),e}startPolling(){this.pollingInterval&&clearInterval(this.pollingInterval),this.pollingInterval=setInterval((()=>{this.getUnreadCount(!0).catch((e=>{console.error("Error in notification polling:",e)}))}),this.pollingDelay)}stopPolling(){this.pollingInterval&&(clearInterval(this.pollingInterval),this.pollingInterval=null)}subscribe(e){if("function"==typeof e)return this.subscribers.push(e),()=>{this.subscribers=this.subscribers.filter((t=>t!==e))};console.warn("Notification subscriber must be a function")}notifySubscribers(){this.subscribers.forEach((e=>{try{e({unreadCount:this.cache.unreadCount,notifications:this.cache.notifications?.notifications||[]})}catch(t){console.error("Error in notification subscriber:",t)}}))}resetCache(){this.cache={notifications:{notifications:[],pagination:{total:0,page:1,limit:10,pages:1},unread_count:0},unreadCount:0,lastFetch:null,fetchPromise:null},this.notifySubscribers()}async markAsRead(e){try{try{const t=await n.post(`/api/notifications/${e}/mark-read`);if(this.cache.unreadCount=t.data.unread_count||0,this.cache.notifications&&this.cache.notifications.notifications){const t=this.cache.notifications.notifications.find((t=>t.id===e));t&&!t.readAt&&(t.readAt=(new Date).toISOString(),t.isRead=!0,void 0!==this.cache.notifications.unread_count&&(this.cache.notifications.unread_count=Math.max(0,this.cache.notifications.unread_count-1)))}return this.notifySubscribers(),t.data}catch(t){return console.log("Using local notification marking due to API error"),this.markNotificationAsReadLocally(e),{success:!0,notification:this.cache.notifications?.notifications?.find((t=>t.id===e))||null,unread_count:this.cache.unreadCount}}}catch(t){return console.error("Error marking notification as read:",t),this.markNotificationAsReadLocally(e),{success:!1,error:t.message,unread_count:this.cache.unreadCount}}}async markAllAsRead(){try{try{const e=await n.post("/api/notifications/mark-read");return this.cache.unreadCount=0,this.cache.notifications&&this.cache.notifications.notifications&&(this.cache.notifications.notifications.forEach((e=>{e.readAt=(new Date).toISOString(),e.isRead=!0})),void 0!==this.cache.notifications.unread_count&&(this.cache.notifications.unread_count=0)),this.notifySubscribers(),e.data}catch(e){return console.log("Using local notification marking due to API error"),this.markAllNotificationsAsReadLocally(),{success:!0,updated:this.cache.notifications?.notifications?.length||0,unread_count:0}}}catch(e){return console.error("Error marking all notifications as read:",e),this.markAllNotificationsAsReadLocally(),{success:!1,error:e.message,unread_count:this.cache.unreadCount}}}async createTestNotification(e="document",t="/dashboard"){try{try{const s=await n.post("/api/notifications/test",{type:e,targetUrl:t});return await this.getNotifications(1,10,!0,!0),s.data}catch(s){console.log("API not available, creating local test notification"),this.useMockBackend=!0;const a=new Date,i={id:`local-${a.getTime()}`,title:`Test Notification (${e})`,message:`Ceci est une notification de test de type "${e}" créée localement`,type:e,targetUrl:t,createdAt:a.toISOString(),readAt:null,isRead:!1};return this.cache.notifications.notifications||(this.cache.notifications.notifications=[]),this.cache.notifications.notifications.unshift(i),this.cache.unreadCount+=1,this.cache.notifications.pagination&&(this.cache.notifications.pagination.total+=1),this.notifySubscribers(),{success:!0,notification:i}}}catch(s){return console.error("Error creating test notification:",s),{success:!1,error:s.message}}}};var L="horizontal",O=["horizontal","vertical"],M=s.forwardRef(((s,a)=>{const{decorative:i,orientation:n=L,...r}=s,c=function(e){return O.includes(e)}(n)?n:L,o=i?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"};return e.jsx(t.div,{"data-orientation":c,...o,...r,ref:a})}));M.displayName="Separator";var V=M;const T=s.forwardRef((({className:t,orientation:s="horizontal",decorative:a=!0,...i},n)=>e.jsx(V,{ref:n,decorative:a,orientation:s,className:r("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",t),...i})));T.displayName=V.displayName;const B=e=>{if(!e)return"";return e.replace(/\D/g,"").replace(/(\d{2})(?=\d)/g,"$1 ").trim()},$=s.memo((({field:t,label:i,icon:n,value:r,type:h="text",isEditing:u,isEditable:m,editedValue:f,onEdit:p,onSave:x,onCancel:g,onChange:b,className:y="",loading:v=!1})=>{const[j,w]=s.useState(r),[N,k]=s.useState(null);s.useEffect((()=>{u||(w(r),k(null),b&&"url"===h&&!u&&b(r))}),[r,u,b,h]);const D=u?f:j||r,R=a.useCallback((async()=>{try{if("url"===h&&f&&!f.startsWith("https://"))return k("L'URL doit commencer par https://"),void c.error("L'URL doit commencer par https://");w(f),p&&p(),await x(t),k(null),"linkedinUrl"===t&&document.dispatchEvent(new CustomEvent("user:data-updated"))}catch(e){w(r),k(e.response?.data?.message||"Une erreur est survenue"),c.error(e.response?.data?.message||"Une erreur est survenue")}}),[x,t,f,p,r,h]);return e.jsxs("div",{className:`\n        rounded-lg transition-all duration-200 \n        ${u?"bg-white dark:bg-gray-800 border-2 border-blue-200 dark:border-[#78b9dd]/40 shadow-sm dark:shadow-[0_0_10px_rgba(120,185,221,0.15)]":"bg-gray-50 dark:bg-gray-800/60 dark:border dark:border-gray-700"} \n        ${u?"":"hover:bg-gray-100 dark:hover:bg-gray-700/70"} \n        p-3 sm:p-4 md:p-5 \n        ${y}\n      `,children:[e.jsxs(E,{className:"text-xs sm:text-sm font-medium text-gray-700 dark:text-gray-300 flex items-center justify-between",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[n,i]}),m&&!u&&e.jsx(o,{variant:"ghost",size:"sm",onClick:p,className:"h-7 w-7 p-1 text-blue-600 dark:text-[#78b9dd] hover:text-blue-700 hover:bg-blue-50 dark:hover:bg-[#78b9dd]/20 dark:hover:text-[#a0d0ec] transition-colors",disabled:v,children:e.jsx(_,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]}),u?e.jsxs("div",{className:"mt-2 space-y-2",children:["phone"===h?e.jsx(S,{value:f,onChange:b,className:"w-full",disabled:v}):e.jsx(C,{type:h,value:f,onChange:e=>b(e.target.value),className:"w-full "+(N?"border-red-500":""),disabled:v,placeholder:"url"===h?"https://...":""}),N&&e.jsx("p",{className:"text-sm text-red-500",children:N}),e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"ghost",size:"sm",onClick:g,disabled:v,children:"Annuler"}),e.jsx(o,{size:"sm",onClick:R,disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"mr-2 h-4 w-4 animate-spin"}),"Enregistrement..."]}):"Enregistrer"})]})]}):e.jsx("div",{className:"mt-1 min-h-[1.5rem]",children:v?e.jsx(l,{className:"h-5 w-full"}):D?"url"===h?e.jsxs("a",{href:D,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 break-all",children:[e.jsx("span",{className:"truncate mr-1",children:(U=D,U?U.length>40?U.substring(0,37)+"...":U:"")}),e.jsx(d,{className:"h-3 w-3 opacity-70 group-hover:opacity-100 flex-shrink-0"})]}):e.jsx("span",{className:"text-gray-900 dark:text-gray-100",children:"phone"===h&&D?B(D):D}):e.jsx("span",{className:"text-gray-500 dark:text-gray-400",children:"Non renseigné"})})]});var U}),((e,t)=>e.value===t.value&&e.isEditing===t.isEditing&&e.editedValue===t.editedValue&&e.loading===t.loading));$.displayName="EditableField";const G=e=>!!e&&(Array.isArray(e)?e.some((e=>{const t="object"==typeof e&&null!==e?e.name:e;return"ROLE_ADMIN"===t||"ADMIN"===t})):"ROLE_ADMIN"===e||"ADMIN"===e),q=e=>!!e&&(Array.isArray(e)?e.some((e=>{const t="object"==typeof e&&null!==e?e.name:e;return"ROLE_SUPER_ADMIN"===t||"SUPER_ADMIN"===t||"SUPERADMIN"===t})):"ROLE_SUPER_ADMIN"===e||"SUPER_ADMIN"===e||"SUPERADMIN"===e),W=e=>!!e&&(Array.isArray(e)?e.some((e=>{const t="object"==typeof e&&null!==e?e.name:e;return"ROLE_STUDENT"===t||"STUDENT"===t})):"ROLE_STUDENT"===e||"STUDENT"===e),X=e=>!!e&&(Array.isArray(e)?e.some((e=>{const t="object"==typeof e&&null!==e?e.name:e;return"ROLE_GUEST"===t||"GUEST"===t})):"ROLE_GUEST"===e||"GUEST"===e),H=e=>G(e)||q(e),J=e=>G(e)||W(e)||X(e)||q(e),K=s.memo((({userData:t,onUpdate:a})=>{const[i,n]=s.useState(null),[r,l]=s.useState(!1),[d,w]=s.useState(null),[N,k]=s.useState(!1),{data:C,isLoading:S,refetch:E}=h("/api/documents/type/CV","userCVDocument",{refetchOnWindowFocus:!1,onError:e=>{console.error("Error fetching CV document:",e)}}),A=C?.data?.[0]||null,{mutate:I,isPending:_}=u("/api/documents/upload/cv","post","userCVDocument",{onSuccess:()=>{c.success("CV téléchargé avec succès"),n(null),E(),document.dispatchEvent(new CustomEvent("user:data-updated")),a&&a();const e={id:Date.now(),title:"CV téléchargé avec succès",message:"Votre CV a été téléchargé avec succès et est prêt à être consulté par les recruteurs.",type:"document_uploaded",isRead:!1,createdAt:(new Date).toISOString(),targetUrl:"/documents"};F.cache.notifications&&F.cache.notifications.notifications&&(F.cache.notifications.notifications.unshift(e),F.cache.unreadCount=(F.cache.unreadCount||0)+1,F.cache.notifications.pagination&&(F.cache.notifications.pagination.total+=1),F.notifySubscribers(),setTimeout((()=>{F.getUnreadCount(!0).catch(console.error)}),300));const t=document.getElementById("cv-upload");t&&(t.value="")},onError:e=>{c.error("Failed to upload CV: "+(e.response?.data?.message||e.message))}}),{mutate:L,isPending:O}=u((e=>`/api/documents/${e}`),"delete","userCVDocument",{onSuccess:()=>{c.success("CV deleted successfully"),E(),document.dispatchEvent(new CustomEvent("user:data-updated")),a&&a()},onError:e=>{c.error("Failed to delete CV: "+(e.response?.data?.message||e.message))}}),M=s.useCallback((e=>{if(w(null),e.target.files&&e.target.files[0]){const t=e.target.files[0];if(t.size>10485760)return void w("File is too large. Maximum size is 10MB.");if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(t.type))return void w("Unsupported file format. Please use PDF, DOC, or DOCX.");n(t)}}),[]),V=s.useCallback((()=>{if(!i)return void c.error("Please select a file");const e=new FormData;e.append("file",i),I(e)}),[i,I]),T=s.useCallback((()=>{A&&A.id?k(!0):c.error("No document to delete")}),[A]),B=s.useCallback((()=>{if(!A||!A.id)return void c.error("No document to delete");k(!1);A.id;const e=A.name;L(A.id);const t={id:Date.now(),title:"Document supprimé",message:`Votre document ${e} a été supprimé avec succès.`,type:"document_deleted",isRead:!1,createdAt:(new Date).toISOString(),targetUrl:"/documents"};F.cache.notifications&&F.cache.notifications.notifications&&(F.cache.notifications.notifications.unshift(t),F.cache.unreadCount=(F.cache.unreadCount||0)+1,F.notifySubscribers(),c.info(t.message,{action:{label:"Voir tous",onClick:()=>{window.location.href=t.targetUrl}}}))}),[A,L,t]),$=s.useCallback((async()=>{if(A&&A.id)try{const e=await fetch(`https://bigproject-development.konstantine.fr/api/documents/${A.id}/download`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.ok)throw new Error("Failed to download document");const t=await e.blob(),s=window.URL.createObjectURL(t),a=document.createElement("a");a.style.display="none",a.href=s,a.download=A.name||"cv.pdf",document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(s),document.body.removeChild(a),c.success("Document téléchargé avec succès")}catch(e){console.error("Erreur lors du téléchargement du CV:",e),c.error("Erreur lors du téléchargement du CV")}else c.error("No document to download")}),[A]),G=s.useCallback((e=>{e.preventDefault(),e.stopPropagation(),"dragenter"===e.type||"dragover"===e.type?l(!0):"dragleave"===e.type&&l(!1)}),[]),q=s.useCallback((e=>{if(e.preventDefault(),e.stopPropagation(),l(!1),w(null),e.dataTransfer.files&&e.dataTransfer.files[0]){const t=e.dataTransfer.files[0];if(t.size>10485760)return void w("File is too large. Maximum size is 10MB.");if(!["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document"].includes(t.type))return void w("Unsupported file format. Please use PDF, DOC, or DOCX.");n(t)}}),[]);return e.jsxs("div",{className:"space-y-4",children:[e.jsx(m,{open:N,onOpenChange:k,children:e.jsxs(f,{children:[e.jsxs(p,{children:[e.jsx(x,{children:"Confirmer la suppression"}),e.jsx(g,{children:"Êtes-vous sûr de vouloir supprimer votre CV ? Cette action est irréversible."})]}),e.jsxs(b,{className:"flex justify-end space-x-2",children:[e.jsx(o,{variant:"outline",onClick:()=>k(!1),children:"Annuler"}),e.jsx(o,{variant:"destructive",onClick:B,disabled:O,children:O?"Suppression...":"Supprimer"})]})]})}),A&&e.jsx("div",{className:"bg-gray-50 p-3 sm:p-4 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[e.jsx(y,{className:"h-5 w-5 sm:h-6 sm:w-6 text-blue-500 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-medium text-sm sm:text-base truncate",children:A.name}),e.jsxs("p",{className:"text-xs sm:text-sm text-gray-500",children:["Ajouté le ",new Date(A.createdAt).toLocaleDateString("fr-FR",{day:"numeric",month:"long",year:"numeric"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row w-full sm:w-auto gap-2 sm:gap-3",children:[e.jsxs(o,{variant:"outline",size:"sm",onClick:$,disabled:O,className:"w-full sm:w-auto text-xs sm:text-sm h-8 sm:h-9 justify-center",children:[e.jsx(D,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5"}),"Télécharger"]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:T,disabled:O,className:"w-full sm:w-auto text-xs sm:text-sm h-8 sm:h-9 justify-center text-red-500 hover:text-red-700",children:[e.jsx(R,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5"}),"Supprimer"]})]})]})}),!A&&e.jsx("div",{className:"border-2 border-dashed rounded-lg p-3 sm:p-6 text-center "+(r?"border-blue-500 bg-blue-50":"border-gray-300"),onDragEnter:G,onDragOver:G,onDragLeave:G,onDrop:q,children:e.jsxs(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.3},className:"space-y-2 sm:space-y-4",children:[e.jsx("div",{className:"mx-auto w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(z,{className:"h-4 w-4 sm:h-6 sm:w-6 text-blue-500"})}),e.jsxs("div",{className:"space-y-1 sm:space-y-2",children:[e.jsx("h3",{className:"text-sm sm:text-lg font-medium",children:"Déposez votre CV ici"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500",children:"Glissez-déposez votre fichier ici, ou cliquez pour parcourir"})]}),e.jsxs("div",{children:[e.jsx("input",{id:"cv-upload",type:"file",accept:".pdf,.doc,.docx",onChange:M,className:"hidden"}),e.jsx(o,{variant:"outline",onClick:()=>document.getElementById("cv-upload").click(),className:"mx-auto text-xs sm:text-sm h-8 sm:h-9 px-3 sm:px-4",children:"Parcourir les fichiers"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Formats acceptés : PDF, DOC, DOCX (max 10MB)"})]})}),i&&!A&&e.jsx("div",{className:"mt-3 bg-gray-50 p-3 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 min-w-0 w-full sm:w-auto",children:[e.jsx(U,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-500 flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"font-medium text-xs sm:text-sm truncate",children:i.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(i.size/1024/1024).toFixed(2)," MB"]})]})]}),e.jsx(o,{onClick:V,disabled:_,size:"sm",className:"w-full sm:w-auto text-xs sm:text-sm h-8 sm:h-9 justify-center",children:_?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e.jsx("span",{children:"Envoi en cours..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1.5"}),"Envoyer"]})})]})}),d&&e.jsxs("div",{className:"mt-2 p-2 sm:p-3 bg-red-50 text-red-700 rounded-md flex items-start space-x-2",children:[e.jsx(P,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-xs sm:text-sm flex-1",children:d})]}),S&&!A&&!i&&e.jsx("div",{className:"text-center py-4 sm:py-6",children:e.jsxs("div",{className:"animate-pulse flex flex-col items-center space-y-2 sm:space-y-3",children:[e.jsx("div",{className:"rounded-full bg-gray-200 h-8 w-8 sm:h-10 sm:w-10"}),e.jsx("div",{className:"h-2 sm:h-3 bg-gray-200 rounded w-32 sm:w-40"}),e.jsx("div",{className:"h-2 bg-gray-200 rounded w-24 sm:w-32"})]})})]})}));K.displayName="CVUpload";const Q=s.memo((({profile:t,onProfileUpdate:a})=>{const[i,n]=s.useState(!1),[r,o]=s.useState(!1),[l,d]=s.useState(!1);s.useEffect((()=>{if(t)try{t.studentProfile?(o(Boolean(t.studentProfile.isSeekingInternship)),d(Boolean(t.studentProfile.isSeekingApprenticeship))):(o(Boolean(t.isSeekingInternship)),d(Boolean(t.isSeekingApprenticeship)))}catch(e){}}),[t]);const h=s.useCallback((async()=>{if(!i)try{n(!0);const e=!r;o(e);const t=await w.toggleInternshipSeeking(e);if(!t||!t.success)throw o(!e),new Error("Échec de la mise à jour");c.success("Recherche d'emploi "+(e?"activée":"désactivée"))}catch(e){console.error("Erreur lors de la mise à jour du statut de recherche de stage:",e),c.error("Une erreur est survenue lors de la mise à jour de votre statut de recherche")}finally{n(!1)}}),[i,r]),u=s.useCallback((async()=>{if(!i)try{n(!0);const e=!l;d(e);const t=await w.toggleApprenticeshipSeeking(e);if(!t||!t.success)throw d(!e),new Error("Échec de la mise à jour");c.success("Recherche d'alternance "+(e?"activée":"désactivée"))}catch(e){console.error("Erreur lors de la mise à jour du statut de recherche d'alternance:",e),c.error("Une erreur est survenue lors de la mise à jour de votre statut de recherche")}finally{n(!1)}}),[i,l]);return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("p",{className:"text-sm sm:text-base text-gray-600",children:["Activez ces options pour indiquer que vous êtes à la recherche d'un emploi et/ou d'une alternance.",e.jsx("strong",{className:"block mt-2 sm:mt-3",children:"Vous pouvez activer les deux options simultanément si vous êtes ouvert aux deux types d'opportunités."})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 sm:p-4 rounded-lg "+(r?"bg-blue-50 border border-blue-200":"bg-gray-50"),children:[e.jsxs("div",{className:"flex items-start sm:items-center space-x-3 mb-3 sm:mb-0",children:[e.jsx("div",{className:"p-2 rounded-full "+(r?"bg-blue-100":"bg-gray-100"),children:e.jsx(N,{className:"h-4 w-4 sm:h-5 sm:w-5 "+(r?"text-blue-600":"text-gray-500")})}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"seeking-internship",className:"text-sm sm:text-base font-medium",children:"Recherche d'emploi"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:"Activez cette option si vous recherchez un emploi"})]})]}),e.jsx(I,{id:"seeking-internship",checked:r,onCheckedChange:h,disabled:i,className:"ml-0 sm:ml-4"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-3 sm:p-4 rounded-lg "+(l?"bg-purple-50 border border-purple-200":"bg-gray-50"),children:[e.jsxs("div",{className:"flex items-start sm:items-center space-x-3 mb-3 sm:mb-0",children:[e.jsx("div",{className:"p-2 rounded-full "+(l?"bg-purple-100":"bg-gray-100"),children:e.jsx(k,{className:"h-4 w-4 sm:h-5 sm:w-5 "+(l?"text-purple-600":"text-gray-500")})}),e.jsxs("div",{children:[e.jsx(E,{htmlFor:"seeking-apprenticeship",className:"text-sm sm:text-base font-medium",children:"Recherche d'alternance"}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:"Activez cette option si vous recherchez une alternance"})]})]}),e.jsx(I,{id:"seeking-apprenticeship",checked:l,onCheckedChange:u,disabled:i,className:"ml-0 sm:ml-4"})]}),(r||l)&&e.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-green-50 border border-green-200 rounded-lg",children:e.jsxs("p",{className:"text-xs sm:text-sm text-green-800",children:[e.jsx("span",{className:"font-semibold",children:"Votre profil est visible"})," par les recruteurs et les entreprises partenaires. Assurez-vous que votre CV est à jour pour maximiser vos chances."]})})]})]})}));Q.displayName="JobSeekingSettings";export{K as C,$ as E,Q as J,_ as P,T as S,z as U,J as a,W as b,H as c,X as d,B as f,G as i};
