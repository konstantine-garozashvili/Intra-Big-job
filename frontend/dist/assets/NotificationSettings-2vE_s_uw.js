import{j as e}from"./ui-DiOaG2iA.js";import{r as s}from"./router-D7BdrHDj.js";import{a0 as a,a1 as r,a2 as t,o as i,p as l,q as o,r as c,s as n,B as d,a3 as m,a4 as u,a5 as x,t as h,A as g,m as p}from"./index-BpIDiI3H.js";import{S as f}from"./switch-CZWMmMQe.js";import{L as j}from"./label-D1xi6yHi.js";import{A as y,a as b,b as N}from"./alert-CRBCn-DA.js";import{P as k}from"./ProfileSettingsSkeleton-DPyG9Ith.js";import"./react-0RZ2pslC.js";import"./query-D8UIi9X6.js";import"./charts-DkICKEBk.js";const v=()=>{const[v,E]=s.useState(!0),[w,P]=s.useState({app:{ROLE_UPDATE:!0}}),[A,D]=s.useState(!1),[L,R]=s.useState(null),{updateNotificationPreference:S}=a(),{user:T}=r();s.useEffect((()=>{(async()=>{E(!0);try{if(T?.id){console.log("Chargement des préférences pour l'utilisateur ID:",T.id);const e=m(u,"notificationPreferences",String(T.id)),s=await x(e);if(s.exists()){const e=s.data();console.log("Préférences chargées depuis Firestore:",e),P({app:{ROLE_UPDATE:!1!==e.ROLE_UPDATE}})}else console.log("Aucune préférence trouvée pour cet utilisateur, utilisation des valeurs par défaut"),P({app:{ROLE_UPDATE:!0}})}else console.log("Pas d'utilisateur, utilisation des valeurs par défaut")}catch(e){console.error("Erreur lors du chargement des paramètres:",e),h.error("Erreur lors du chargement des paramètres")}finally{E(!1)}})()}),[T]);const O=({category:s,setting:a,label:r,description:t})=>{const i=w[s][a],l=L&&L.category===s&&L.setting===a;return e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg transition-colors hover:bg-gray-50 dark:hover:bg-gray-700/50 "+(l?"bg-blue-50/50 dark:bg-blue-900/20":""),children:[e.jsxs("div",{className:"space-y-0.5 flex-1 mr-4",children:[e.jsx(j,{htmlFor:`${s}-${a}`,className:"text-gray-900 dark:text-gray-100 font-medium cursor-pointer",children:r}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:t})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{id:`${s}-${a}`,checked:i,onCheckedChange:()=>((e,s)=>{R({category:e,setting:s}),P((a=>({...a,[e]:{...a[e],[s]:!a[e][s]}}))),setTimeout((()=>{R(null)}),1e3)})(s,a),className:(i?"dark:bg-blue-500":"dark:bg-gray-600")+" transition-all duration-200"}),e.jsx("div",{className:"ml-2 w-16 text-right relative h-5",children:e.jsx(g,{mode:"wait",children:e.jsx(p.span,{initial:{y:-10,opacity:0},animate:{y:0,opacity:1},exit:{y:10,opacity:0},transition:{duration:.2},className:"absolute right-0 text-xs font-medium "+(i?"text-blue-600 dark:text-blue-400":"text-gray-500 dark:text-gray-400"),children:i?"Activé":"Désactivé"},i?"on":"off")})})]})]})};return v?e.jsx("div",{className:"space-y-6 bg-white dark:bg-gray-800 p-6 rounded-lg shadow dark:shadow-blue-900/10",children:e.jsx(k,{type:"notifications"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Notifications"})]}),e.jsxs(y,{className:"border dark:border-blue-800 dark:bg-blue-900/20",children:[e.jsx(t,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),e.jsx(b,{className:"dark:text-white",children:"Gérez vos notifications"}),e.jsx(N,{className:"dark:text-gray-300",children:"Personnalisez la façon dont vous souhaitez être informé des activités importantes."})]}),e.jsx("div",{className:"grid gap-6",children:e.jsxs(i,{className:"border dark:border-gray-700 transition-all hover:shadow-md dark:hover:shadow-blue-900/10",children:[e.jsxs(l,{className:"dark:border-b dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"h-5 w-5 text-blue-600 dark:text-blue-400"}),e.jsx(o,{className:"dark:text-white",children:"Notifications système"})]}),e.jsx(c,{className:"dark:text-gray-400",children:"Gérez vos notifications système."})]}),e.jsx(n,{className:"space-y-4",children:e.jsx(O,{category:"app",setting:"ROLE_UPDATE",label:"Changements de rôle",description:"Recevez des notifications lorsque votre rôle est modifié."})})]})}),e.jsx("div",{className:"flex justify-end gap-2",children:e.jsx(d,{onClick:async()=>{D(!0);try{await S("ROLE_UPDATE",w.app.ROLE_UPDATE),h.success("Paramètres de notification mis à jour")}catch(e){console.error("Erreur lors de la sauvegarde:",e),h.error("Erreur lors de la mise à jour des paramètres")}finally{D(!1)}},disabled:A,className:"transition-all",children:A?"Enregistrement...":"Enregistrer les modifications"})})]})};export{v as default};
