import{j as e}from"./ui-CEgDFHEN.js";import{u as s,r as a,L as t}from"./router-Cgxi-4fo.js";import{a3 as l,c as r,ay as i,B as c,bi as n,aD as o,aE as d,aF as m,i as x,t as u,a5 as h,q as j,w as g,aj as b,bj as N,bk as p,bl as y,aN as w,U as f,S as k,ad as v}from"./index-DPBizqV0.js";import{T as D,a as E,b as C,c as T}from"./tooltip-CrspzI1l.js";import{f as P}from"./index-BvyXXQGh.js";import"./react-0RZ2pslC.js";import"./query-CdiCT4_A.js";import"./charts-D4j3G6dB.js";const A=e=>{try{return e&&"function"==typeof e.toDate?P(e.toDate(),"PPp",{locale:v}):e instanceof Date?P(e,"PPp",{locale:v}):"number"==typeof e||"string"==typeof e?P(new Date(e),"PPp",{locale:v}):"Date inconnue"}catch(s){return console.error("Erreur lors du formatage de la date:",s),"Date incorrecte"}},O={ROLE_UPDATE:{label:"Mise à jour de rôle",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",icon:e.jsx(w,{className:"h-4 w-4"})},INFO_UPDATE:{label:"Mise à jour de profil",color:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300",icon:e.jsx(f,{className:"h-4 w-4"})},SYSTEM:{label:"Système",color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",icon:e.jsx(h,{className:"h-4 w-4"})},INFO:{label:"Information",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",icon:e.jsx(w,{className:"h-4 w-4"})},WARNING:{label:"Avertissement",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",icon:e.jsx(w,{className:"h-4 w-4"})},ALERT:{label:"Alerte",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",icon:e.jsx(w,{className:"h-4 w-4"})},DOCUMENT_APPROVED:{label:"Document approuvé",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",icon:e.jsx(y,{className:"h-4 w-4"})},DOCUMENT_REJECTED:{label:"Document rejeté",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",icon:e.jsx(p,{className:"h-4 w-4"})},DOCUMENT_UPLOADED:{label:"Document importé",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",icon:e.jsx(b,{className:"h-4 w-4"})},DOCUMENT_DELETED:{label:"Document supprimé",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",icon:e.jsx(N,{className:"h-4 w-4"})},DOCUMENT_UPDATED:{label:"Document mis à jour",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",icon:e.jsx(b,{className:"h-4 w-4"})},GUEST_APPLICATION:{label:"Demande invité",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",icon:e.jsx(h,{className:"h-4 w-4"})}},U=()=>{const b=s(),{notifications:N,loading:p,unreadCount:y,markAsRead:w,markAllAsRead:f}=l(),[v,P]=a.useState("all"),[U,M]=a.useState(null),L=N.reduce(((e,s)=>(s.type&&(e[s.type]=(e[s.type]||0)+1),e)),{}),R=Object.keys(L).length>1,_=(()=>{if(!N)return[];let e=[...N];return"unread"===v&&(e=e.filter((e=>!e.read))),U&&(e=e.filter((e=>e.type===U))),e})();return e.jsxs("div",{className:"container mx-auto max-w-4xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(t,{to:"/dashboard",className:"mr-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 hover:dark:text-blue-300",children:e.jsx(r,{className:"h-6 w-6"})}),e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:["Notifications",y>0&&"unread"!==v&&e.jsxs(i,{className:"ml-2 bg-red-500 text-white",children:[y," non ",y>1?"lues":"lue"]})]})]}),e.jsx(D,{children:e.jsxs(E,{children:[e.jsx(C,{asChild:!0,children:e.jsx(t,{to:"/settings/notifications",children:e.jsxs(c,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(n,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Paramètres"})]})})}),e.jsx(T,{children:e.jsx("p",{children:"Gérer vos préférences de notifications"})})]})})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[e.jsx(o,{value:v,onValueChange:P,className:"w-full sm:w-auto",children:e.jsxs(d,{children:[e.jsx(m,{value:"all",children:"Toutes"}),e.jsxs(m,{value:"unread",children:["Non lues ",y>0&&`(${y})`]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:R&&e.jsxs(e.Fragment,{children:[Object.entries(O).filter((([e])=>L[e])).map((([s,a])=>e.jsx(i,{className:"cursor-pointer "+(U===s?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-100 text-gray-800 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"),onClick:()=>M(U===s?null:s),children:a.label},s))),U&&e.jsx(c,{variant:"ghost",size:"sm",className:"text-xs h-7",onClick:()=>M(null),children:"Réinitialiser"})]})}),y>0&&e.jsxs(c,{variant:"outline",size:"sm",className:"ml-auto",onClick:()=>{f(),u.success("Toutes les notifications ont été marquées comme lues")},children:[e.jsx(x,{className:"h-4 w-4 mr-2"}),"Tout marquer comme lu"]})]}),p?e.jsx("div",{className:"space-y-4",children:Array(5).fill(0).map(((s,a)=>e.jsx(j,{className:"mb-3",children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(k,{className:"h-5 w-5 rounded-full mr-3 mt-1"}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(k,{className:"h-5 w-40"}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(k,{className:"h-3 w-24 mb-1"}),e.jsx(k,{className:"h-2 w-16"})]})]}),e.jsx(k,{className:"h-4 w-full mt-2"}),e.jsx(k,{className:"h-4 w-3/4 mt-1"})]})]})})},a)))}):0===_.length?e.jsxs("div",{className:"text-center p-8",children:[e.jsx(h,{className:"h-10 w-10 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Pas de notification"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2 max-w-md mx-auto",children:"all"===v?"Vous n'avez aucune notification pour le moment.":"Vous n'avez aucune notification non lue pour le moment."})]}):e.jsx("div",{className:"space-y-4",children:_.map((s=>e.jsx(j,{className:"cursor-pointer transition-shadow hover:shadow-md "+(s.read?"":"border-l-4 border-l-blue-500 dark:border-l-blue-400"),onClick:()=>(e=>{w(e.id),"INFO"===e.type&&e.title&&(e.title.toLowerCase().includes("votre demande d'inscription a été acceptée")||e.title.toLowerCase().includes("votre demande d'inscription a été refusée"))?b("/settings/notifications"):e.targetUrl&&b(e.targetUrl)})(s),children:e.jsx(g,{className:"p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-3 mt-1",children:O[s.type]?.icon||e.jsx(h,{className:"h-5 w-5 text-gray-500"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"text-base font-medium "+(s.read?"text-gray-700 dark:text-gray-300":"text-gray-900 dark:text-white"),children:s.title}),e.jsx("div",{className:"flex flex-col items-end",children:e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:A(s.timestamp)})})]}),(()=>{if(s.message&&s.message.includes("Commentaire du recruteur :")){const[a,t]=s.message.split(/\nCommentaire du recruteur ?: ?/);return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:a}),e.jsxs("div",{className:"mt-2 p-2 rounded bg-yellow-50 dark:bg-yellow-900/30 border-l-4 border-yellow-400 text-yellow-900 dark:text-yellow-100 text-sm font-medium whitespace-pre-line",children:[e.jsx("span",{className:"font-semibold",children:"Commentaire du recruteur :"})," ",t]})]})}return e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:s.message})})(),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(i,{className:O[s.type]?.color||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:O[s.type]?.label||s.type||"Notification"}),!s.read&&e.jsxs(c,{variant:"ghost",size:"sm",className:"ml-auto text-xs py-1 h-auto",onClick:e=>{e.stopPropagation(),w(s.id)},children:[e.jsx(x,{className:"h-3 w-3 mr-1"}),"Marquer comme lu"]})]})]})]})})},s.id)))})]})};export{U as default};
