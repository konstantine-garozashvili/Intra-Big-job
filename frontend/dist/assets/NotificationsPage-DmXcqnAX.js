import{j as e}from"./ui-B5ZVMT00.js";import{u as a,r as s,L as t}from"./router-Cgxi-4fo.js";import{a2 as l,c as r,ay as i,aD as c,aE as n,aF as o,B as d,bm as m,aG as x,aH as u,aI as h,aJ as g,i as j,t as b,a4 as N,q as p,w as y,ai as w,bn as f,bo as k,bp as v,aR as D,U as E,S as C,ac as P}from"./index-CoAfTMaM.js";import{f as T}from"./index-CuqQreUV.js";import"./react-0RZ2pslC.js";import"./query-DUefEkVx.js";import"./charts-D4j3G6dB.js";const A=e=>{try{return e&&"function"==typeof e.toDate?T(e.toDate(),"PPp",{locale:P}):e instanceof Date?T(e,"PPp",{locale:P}):"number"==typeof e||"string"==typeof e?T(new Date(e),"PPp",{locale:P}):"Date inconnue"}catch(a){return console.error("Erreur lors du formatage de la date:",a),"Date incorrecte"}},O={ROLE_UPDATE:{label:"Mise à jour de rôle",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",icon:e.jsx(D,{className:"h-4 w-4"})},INFO_UPDATE:{label:"Mise à jour de profil",color:"bg-teal-100 text-teal-800 dark:bg-teal-900 dark:text-teal-300",icon:e.jsx(E,{className:"h-4 w-4"})},SYSTEM:{label:"Système",color:"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-300",icon:e.jsx(N,{className:"h-4 w-4"})},INFO:{label:"Information",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",icon:e.jsx(D,{className:"h-4 w-4"})},WARNING:{label:"Avertissement",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",icon:e.jsx(D,{className:"h-4 w-4"})},ALERT:{label:"Alerte",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",icon:e.jsx(D,{className:"h-4 w-4"})},DOCUMENT_APPROVED:{label:"Document approuvé",color:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-300",icon:e.jsx(v,{className:"h-4 w-4"})},DOCUMENT_REJECTED:{label:"Document rejeté",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",icon:e.jsx(k,{className:"h-4 w-4"})},DOCUMENT_UPLOADED:{label:"Document importé",color:"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-300",icon:e.jsx(w,{className:"h-4 w-4"})},DOCUMENT_DELETED:{label:"Document supprimé",color:"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-300",icon:e.jsx(f,{className:"h-4 w-4"})},DOCUMENT_UPDATED:{label:"Document mis à jour",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",icon:e.jsx(w,{className:"h-4 w-4"})},GUEST_APPLICATION:{label:"Demande invité",color:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-300",icon:e.jsx(N,{className:"h-4 w-4"})}},U=()=>{const w=a(),{notifications:f,loading:k,unreadCount:v,markAsRead:D,markAllAsRead:E}=l(),[P,T]=s.useState("all"),[U,M]=s.useState(null),R=f.reduce(((e,a)=>(a.type&&(e[a.type]=(e[a.type]||0)+1),e)),{}),I=Object.keys(R).length>1,L=(()=>{if(!f)return[];let e=[...f];return"unread"===P&&(e=e.filter((e=>!e.read))),U&&(e=e.filter((e=>e.type===U))),e})();return e.jsxs("div",{className:"container mx-auto max-w-4xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(t,{to:"/dashboard",className:"mr-2 text-blue-600 hover:text-blue-800 dark:text-blue-400 hover:dark:text-blue-300",children:e.jsx(r,{className:"h-6 w-6"})}),e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white flex items-center",children:["Notifications",v>0&&"unread"!==P&&e.jsxs(i,{className:"ml-2 bg-red-500 text-white",children:[v," non ",v>1?"lues":"lue"]})]})]}),e.jsx(c,{children:e.jsxs(n,{children:[e.jsx(o,{asChild:!0,children:e.jsx(t,{to:"/settings/notifications",children:e.jsxs(d,{variant:"outline",size:"sm",className:"flex items-center gap-2",children:[e.jsx(m,{className:"h-4 w-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Paramètres"})]})})}),e.jsx(x,{children:e.jsx("p",{children:"Gérer vos préférences de notifications"})})]})})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6",children:[e.jsx(u,{value:P,onValueChange:T,className:"w-full sm:w-auto",children:e.jsxs(h,{children:[e.jsx(g,{value:"all",children:"Toutes"}),e.jsxs(g,{value:"unread",children:["Non lues ",v>0&&`(${v})`]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2 w-full sm:w-auto",children:I&&e.jsxs(e.Fragment,{children:[Object.entries(O).filter((([e])=>R[e])).map((([a,s])=>e.jsx(i,{className:"cursor-pointer "+(U===a?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-100 text-gray-800 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"),onClick:()=>M(U===a?null:a),children:s.label},a))),U&&e.jsx(d,{variant:"ghost",size:"sm",className:"text-xs h-7",onClick:()=>M(null),children:"Réinitialiser"})]})}),v>0&&e.jsxs(d,{variant:"outline",size:"sm",className:"ml-auto",onClick:()=>{E(),b.success("Toutes les notifications ont été marquées comme lues")},children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"Tout marquer comme lu"]})]}),k?e.jsx("div",{className:"space-y-4",children:Array(5).fill(0).map(((a,s)=>e.jsx(p,{className:"mb-3",children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(C,{className:"h-5 w-5 rounded-full mr-3 mt-1"}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(C,{className:"h-5 w-40"}),e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsx(C,{className:"h-3 w-24 mb-1"}),e.jsx(C,{className:"h-2 w-16"})]})]}),e.jsx(C,{className:"h-4 w-full mt-2"}),e.jsx(C,{className:"h-4 w-3/4 mt-1"})]})]})})},s)))}):0===L.length?e.jsxs("div",{className:"text-center p-8",children:[e.jsx(N,{className:"h-10 w-10 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-700 dark:text-gray-300",children:"Pas de notification"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2 max-w-md mx-auto",children:"all"===P?"Vous n'avez aucune notification pour le moment.":"Vous n'avez aucune notification non lue pour le moment."})]}):e.jsx("div",{className:"space-y-4",children:L.map((a=>e.jsx(p,{className:"cursor-pointer transition-shadow hover:shadow-md "+(a.read?"":"border-l-4 border-l-blue-500 dark:border-l-blue-400"),onClick:()=>(e=>{D(e.id),"INFO"===e.type&&e.title&&(e.title.toLowerCase().includes("votre demande d'inscription a été acceptée")||e.title.toLowerCase().includes("votre demande d'inscription a été refusée"))?w("/settings/notifications"):e.targetUrl&&w(e.targetUrl)})(a),children:e.jsx(y,{className:"p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx("div",{className:"mr-3 mt-1",children:O[a.type]?.icon||e.jsx(N,{className:"h-5 w-5 text-gray-500"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"text-base font-medium "+(a.read?"text-gray-700 dark:text-gray-300":"text-gray-900 dark:text-white"),children:a.title}),e.jsx("div",{className:"flex flex-col items-end",children:e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:A(a.timestamp)})})]}),(()=>{if(a.message&&a.message.includes("Commentaire du recruteur :")){const[s,t]=a.message.split(/\nCommentaire du recruteur ?: ?/);return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:s}),e.jsxs("div",{className:"mt-2 p-2 rounded bg-yellow-50 dark:bg-yellow-900/30 border-l-4 border-yellow-400 text-yellow-900 dark:text-yellow-100 text-sm font-medium whitespace-pre-line",children:[e.jsx("span",{className:"font-semibold",children:"Commentaire du recruteur :"})," ",t]})]})}return e.jsx("p",{className:"mt-1 text-sm text-gray-600 dark:text-gray-400",children:a.message})})(),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsx(i,{className:O[a.type]?.color||"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-300",children:O[a.type]?.label||a.type||"Notification"}),!a.read&&e.jsxs(d,{variant:"ghost",size:"sm",className:"ml-auto text-xs py-1 h-auto",onClick:e=>{e.stopPropagation(),D(a.id)},children:[e.jsx(j,{className:"h-3 w-3 mr-1"}),"Marquer comme lu"]})]})]})]})})},a.id)))})]})};export{U as default};
