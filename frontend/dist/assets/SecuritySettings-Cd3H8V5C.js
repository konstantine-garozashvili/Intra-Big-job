import{j as e}from"./ui-B9MhWaVJ.js";import{r as s}from"./router-D7BdrHDj.js";import{X as a,Y as t,n as r,o as i,p as c,q as o,r as n,B as l,s as d,t as u,a as m}from"./index-Dh3VsLo2.js";import{I as h}from"./input-D_0VsEmu.js";import{L as p}from"./label-CKTbyxqy.js";import{A as x,a as j,b as f}from"./alert-A6WFojaW.js";import{P as v}from"./ProfileSettingsSkeleton-CifTtqe2.js";import{E as g,a as y}from"./eye-CNSvWuuQ.js";import"./react-0RZ2pslC.js";import"./query-DKQ6_O-p.js";import"./charts-DkICKEBk.js";
/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N=a("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]),w=a("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),b=()=>{const[a,b]=s.useState(""),[S,z]=s.useState(""),[C,k]=s.useState(""),[q,M]=s.useState(!1),[P,L]=s.useState(!0),[A,E]=s.useState(!1),[I,V]=s.useState(!1),[F,B]=s.useState(!1);s.useEffect((()=>{(async()=>{L(!1)})()}),[]);return P?e.jsx("div",{className:"space-y-6 bg-white p-6 rounded-lg shadow",children:e.jsx(v,{type:"security"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{className:"h-6 w-6"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Sécurité"})]}),e.jsxs(x,{children:[e.jsx(t,{className:"h-4 w-4"}),e.jsx(j,{children:"Sécurité du compte"}),e.jsx(f,{children:"Protégez votre compte en utilisant un mot de passe fort et en activant l'authentification à deux facteurs."})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),e.jsx(c,{children:"Changer le mot de passe"})]}),e.jsx(o,{children:"Choisissez un mot de passe fort et unique que vous n'utilisez pour aucun autre compte."})]}),e.jsx(n,{children:e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),a)if(S)if(S.length<8)u.error("Le nouveau mot de passe doit contenir au moins 8 caractères");else if(S===C)if(a!==S){M(!0);try{const e=await m.changePassword({currentPassword:a,newPassword:S});e.success?(u.success(e.message||"Mot de passe modifié avec succès"),b(""),z(""),k("")):u.error(e.message||"Erreur lors du changement de mot de passe")}catch(s){u.error(s.response?.data?.message||"Erreur lors du changement de mot de passe")}finally{M(!1)}}else u.error("Le nouveau mot de passe doit être différent du mot de passe actuel");else u.error("Les mots de passe ne correspondent pas");else u.error("Veuillez saisir un nouveau mot de passe");else u.error("Veuillez saisir votre mot de passe actuel")},className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"current-password",children:"Mot de passe actuel"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"current-password",type:A?"text":"password",value:a,onChange:e=>b(e.target.value),required:!0,className:"pr-10"}),e.jsx(l,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>E(!A),tabIndex:"-1",children:A?e.jsx(g,{className:"h-4 w-4 text-gray-500"}):e.jsx(y,{className:"h-4 w-4 text-gray-500"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"new-password",children:"Nouveau mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"new-password",type:I?"text":"password",value:S,onChange:e=>z(e.target.value),required:!0,className:"pr-10"}),e.jsx(l,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>V(!I),tabIndex:"-1",children:I?e.jsx(g,{className:"h-4 w-4 text-gray-500"}):e.jsx(y,{className:"h-4 w-4 text-gray-500"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"confirm-password",children:"Confirmer le nouveau mot de passe"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"confirm-password",type:F?"text":"password",value:C,onChange:e=>k(e.target.value),required:!0,className:"pr-10"}),e.jsx(l,{type:"button",variant:"ghost",size:"icon",className:"absolute right-0 top-0 h-full px-3",onClick:()=>B(!F),tabIndex:"-1",children:F?e.jsx(g,{className:"h-4 w-4 text-gray-500"}):e.jsx(y,{className:"h-4 w-4 text-gray-500"})})]})]}),e.jsx(l,{type:"submit",disabled:q,children:q?"Modification en cours...":"Modifier le mot de passe"})]})})]}),e.jsxs(r,{children:[e.jsxs(i,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"h-5 w-5"}),e.jsx(c,{children:"Authentification à deux facteurs"})]}),e.jsx(o,{children:"Ajoutez une couche de sécurité supplémentaire à votre compte en activant l'authentification à deux facteurs."})]}),e.jsxs(n,{children:[e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"L'authentification à deux facteurs ajoute une couche de sécurité supplémentaire à votre compte en demandant un code en plus de votre mot de passe."}),e.jsx(l,{variant:"outline",children:"Configurer l'authentification à deux facteurs"})]}),e.jsx(d,{className:"bg-muted/50",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Vous devrez entrer un code à chaque connexion une fois l'authentification à deux facteurs activée."})})]})]})]})};export{b as default};
