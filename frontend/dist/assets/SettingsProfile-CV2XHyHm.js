import{j as e}from"./ui-CEgDFHEN.js";import{r as s,b as a}from"./router-Cgxi-4fo.js";import{z as r,E as l,F as t,G as i,U as o,H as d,B as n,D as c,k as m,I as u,l as h,n as p,J as x,S as f,t as g,j,K as N,M as w,L as v,N as b,O as y,Q as E,R as U,T as k,V as D,W as C,X as P,Y as S,q as M,r as L,s as A,v as F,w as I,p as R,Z as T,b as O}from"./index-BnANEtVp.js";import{u as _}from"./query-CdiCT4_A.js";import{L as q}from"./loader-circle-tYz9PP6p.js";import{U as z,E as $,S as Q,f as V,P as K,a as B,b as G}from"./JobSeekingSettings-DsbrGPRZ.js";import{T as W}from"./trash-2-B7QEiv6g.js";import{i as Y,b as J,c as H,d as Z,e as X}from"./phone-input-DxSsdugA.js";import{L as ee}from"./label-T_DAMYbi.js";import{I as se}from"./input-DQoClNUI.js";import{a as ae}from"./api-BiIojFwK.js";import{P as re}from"./phone-CKibPIq7.js";import"./command-BVDWa1pB.js";import"./react-0RZ2pslC.js";import"./charts-D4j3G6dB.js";import"./index-DLO_YBUS.js";import"./download-BlJ8yCz1.js";import"./circle-alert-MkLjJhtw.js";import"./switch-CIzLH02W.js";
/**
 * @license lucide-react v0.476.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=r("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]),te=r("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]),ie=()=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx(f,{className:"w-20 h-20 sm:w-28 sm:h-28 md:w-32 md:h-32 rounded-full"}),e.jsx(f,{className:"absolute bottom-2 right-2 w-6 h-6 sm:w-8 sm:h-8 rounded-full"})]}),e.jsx(f,{className:"h-6 w-32 mb-1"}),e.jsx(f,{className:"h-4 w-48"})]}),oe=({userData:r,onProfilePictureChange:f,isLoading:j=!1})=>{const N=s.useRef(null),[w,v]=a.useState(!1),[b,y]=a.useState(!1),{profilePictureUrl:E,isLoading:U,isFetching:k,refetch:D,uploadProfilePicture:C,deleteProfilePicture:P,uploadStatus:S,deleteStatus:M}=l(),L=s.useRef(null);s.useRef(((e,s)=>{let a;return function(...r){clearTimeout(a),a=setTimeout((()=>{clearTimeout(a),e(...r)}),s)}})((e=>{var s;!f||((s=e)&&s.startsWith("blob:")||s===L.current||(L.current=s,0))||(console.log("ProfilePicture - Profile picture URL changed, notifying parent (debounced)"),f(e))}),2e3)).current,a.useEffect((()=>{}),[E]);const A=()=>{S.isPending||M.isPending||N.current?.click()},F=U||k||M.isPending||S.isPending||j;if(U&&!E)return e.jsx(ie,{});return e.jsxs("div",{className:"p-4 sm:p-6 max-w-md mx-auto",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-3",children:[e.jsxs("div",{className:"w-20 h-20 sm:w-28 sm:h-28 md:w-32 md:h-32 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden group relative cursor-pointer border-2 border-white dark:border-gray-700 shadow-sm",onClick:A,children:[S.isPending||b?e.jsx(q,{className:"w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10 text-gray-400 animate-spin"}):E?e.jsx("img",{src:E?E.startsWith("blob:")?(console.log("Blob URL detected, using fallback:",E),null):E:null,alt:"Photo de profil",className:"object-cover w-full h-full",onError:e=>{console.error("Image failed to load:",e.target.src),e.target.style.display="none",e.target.onerror=null;const s=document.createElement("div");s.innerHTML='<div class="w-full h-full flex items-center justify-center"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-10 h-10 sm:w-14 sm:h-14 md:w-16 md:h-16 text-gray-400"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg></div>',e.target.parentNode.appendChild(s.firstChild)}}):e.jsx(t,{className:"w-full h-full",children:e.jsx(i,{className:"bg-gradient-to-r from-[#02284f] to-[#03386b] text-white",children:e.jsx(o,{className:"w-10 h-10 sm:w-14 sm:h-14 md:w-16 md:h-16"})})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(d,{className:"w-6 h-6 sm:w-8 sm:h-8 md:w-10 md:h-10 text-white"})})]}),e.jsx("input",{ref:N,type:"file",accept:"image/*",className:"hidden",onChange:async e=>{const s=e.target.files?.[0];if(!s)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(s.type))return void g.error("Type de fichier non autorisé. Formats acceptés: JPG, PNG, GIF, WEBP");const a=s.name.substring(s.name.lastIndexOf(".")).toLowerCase();if(![".jpg",".jpeg",".png",".gif",".webp"].includes(a))return void g.error("Extension de fichier non autorisée. Extensions acceptées: JPG, PNG, GIF, WEBP");if(s.size>2097152)g.error("La taille du fichier dépasse la limite autorisée (2MB)");else try{const e=s.name.split("."),a=e.pop().toLowerCase(),r=`${e.join(".")}.${a}`,l=new File([s],r,{type:s.type}),t=new FormData;t.append("profile_picture",l),C(t,{onSuccess:()=>{g.success("Photo de profil mise à jour avec succès")},onError:()=>{g.error("Erreur lors de la mise à jour de la photo de profil")}})}catch(r){console.error("Erreur non gérée lors de l'upload:",r),g.error("Erreur lors de la mise à jour de la photo de profil")}}}),e.jsx(n,{variant:"ghost",size:"icon",className:"absolute bottom-0 right-0 rounded-full p-1 sm:p-1.5 md:p-2 bg-white dark:bg-gray-700 shadow-sm hover:bg-gray-100 dark:hover:bg-gray-600",onClick:A,disabled:F,children:e.jsx(z,{className:"w-3 h-3 sm:w-4 sm:h-4 md:w-5 md:h-5"})}),E&&e.jsx(n,{variant:"ghost",size:"icon",onClick:()=>v(!0),disabled:F,className:"absolute top-0 right-0 rounded-full p-1 sm:p-1.5 md:p-2 bg-white dark:bg-gray-700 shadow-sm hover:bg-red-50 hover:text-red-600 transition-colors",children:M.isPending?e.jsx(q,{className:"w-3 h-3 sm:w-4 sm:h-4 md:w-5 md:h-5 animate-spin"}):e.jsx(W,{className:"w-3 h-3 sm:w-4 sm:h-4 md:w-5 md:h-5"})})]}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-gray-100 mb-1",children:"Photo de profil"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"Mettre à jour votre photo"})]}),e.jsx(c,{open:w,onOpenChange:e=>!M.isPending&&v(e),children:e.jsxs(m,{className:"max-h-[calc(100vh-2rem)] w-full max-w-md overflow-hidden rounded-2xl border-0 shadow-xl",children:[e.jsx("div",{className:"overflow-y-auto max-h-[70vh] fade-in-up",children:e.jsxs(u,{children:[e.jsx(h,{className:"text-xl font-semibold",children:"Confirmation de suppression"}),e.jsx(p,{className:"text-base mt-2",children:"Êtes-vous sûr de vouloir supprimer votre photo de profil ? Cette action est irréversible."})]})}),e.jsxs(x,{className:"mt-6 flex justify-end space-x-2",children:[e.jsx(n,{variant:"outline",onClick:()=>v(!1),disabled:M.isPending,className:"rounded-full border-2 hover:bg-gray-100 transition-all duration-200",children:"Annuler"}),e.jsx(n,{variant:"destructive",onClick:async()=>{try{v(!1),y(!0),D(),await P(null,{onSuccess:()=>{setTimeout((()=>{D()}),300)},onError:e=>{D(),g.error("Erreur lors de la suppression de la photo de profil")}})}catch(e){g.error("Erreur lors de la suppression de la photo de profil")}finally{y(!1)}},disabled:M.isPending,className:"rounded-full bg-gradient-to-r from-red-500 to-red-700 hover:from-red-600 hover:to-red-800 transition-all duration-200 "+(M.isPending?"opacity-80":""),children:M.isPending?"Suppression...":"Supprimer"})]})]})})]})},de=()=>e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsx(f,{className:"h-10 w-48 mb-8"}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm mb-8",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-6 mb-6",children:[e.jsx(f,{className:"h-24 w-24 rounded-full"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"h-6 w-48"}),e.jsx(f,{className:"h-4 w-32"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(f,{className:"h-16 w-full"}),e.jsx(f,{className:"h-16 w-full"}),e.jsx(f,{className:"h-16 w-full"}),e.jsx(f,{className:"h-16 w-full"})]}),e.jsx(f,{className:"h-16 w-full"}),e.jsx(f,{className:"h-16 w-full"}),e.jsxs("div",{className:"mt-8",children:[e.jsx(f,{className:"h-6 w-32 mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(f,{className:"h-16 w-full"}),e.jsx(f,{className:"h-16 w-full"})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx(f,{className:"h-10 w-48"})})]})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm",children:[e.jsx(f,{className:"h-6 w-48 mb-6"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(f,{className:"h-16 w-full"}),e.jsx(f,{className:"h-16 w-full"})]})]})]}),ne=({userData:s,editedData:a,editMode:r,isFieldEditable:l,toggleFieldEdit:t,handleCancelField:i,handleInputChange:d,onSave:n})=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-5 md:gap-6",children:[e.jsx("div",{className:"address-edit-card w-full",children:l("firstName")?e.jsx($,{field:"firstName",label:"Prénom",icon:e.jsx(o,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5 sm:mr-2 text-gray-500"}),value:s.firstName,editedValue:a.personal.firstName,isEditing:r.firstName,isEditable:!0,onEdit:()=>t("firstName"),onSave:n,onCancel:()=>i("firstName"),onChange:e=>d("firstName",e)}):e.jsx(Q,{label:"Prénom",icon:e.jsx(o,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5 sm:mr-2 text-gray-500"}),value:s.firstName||"Non renseigné"})}),e.jsx("div",{className:"address-edit-card w-full",children:l("lastName")?e.jsx($,{field:"lastName",label:"Nom",icon:e.jsx(o,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5 sm:mr-2 text-gray-500"}),value:s.lastName,editedValue:a.personal.lastName,isEditing:r.lastName,isEditable:!0,onEdit:()=>t("lastName"),onSave:n,onCancel:()=>i("lastName"),onChange:e=>d("lastName",e)}):e.jsx(Q,{label:"Nom",icon:e.jsx(o,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5 sm:mr-2 text-gray-500"}),value:s.lastName||"Non renseigné"})}),e.jsx("div",{className:"address-edit-card w-full",children:e.jsx(Q,{label:"Date de naissance",icon:e.jsx(j,{className:"h-4 w-4 mr-2 text-blue-500"}),value:`${V(s.birthDate)}${s.age?` (${s.age} ans)`:""}`})}),e.jsx("div",{className:"address-edit-card w-full",children:e.jsx(Q,{label:"Nationalité",icon:e.jsx(N,{className:"h-4 w-4 mr-2 text-blue-500"}),value:s.nationality?.name||"Non renseignée"})})]}),ce=({userData:a,editedData:r,editMode:l,setEditMode:t,setEditedData:i,onSaveAddress:o,handleCancelAddress:d,isEditable:c=!0})=>{const m="address",u=l[m],h=a.addresses&&a.addresses.length>0?a.addresses[0]:null,[p,x]=s.useState(""),[f,j]=s.useState([]),[N,y]=s.useState(!1),[E,U]=s.useState(!1),k=s.useRef(null),D=s.useRef(null),[C,P]=s.useState(null);s.useEffect((()=>{const e=setTimeout((()=>{p&&(async e=>{if(!e||e.length<3)return j([]),void U(!1);y(!0);try{const s=await ae.searchAddress(e);j(s),U(s.length>0)}catch(s){console.error("Erreur lors de la recherche d'adresses:",s),g.error("Erreur lors de la recherche d'adresses")}finally{y(!1)}})(p)}),300);return()=>clearTimeout(e)}),[p]),s.useEffect((()=>{p.length>=3&&!C?U(f.length>0):U(!1)}),[p,f,C]),s.useEffect((()=>{const e=e=>{k.current&&!k.current.contains(e.target)&&D.current&&!D.current.contains(e.target)&&U(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const[S,M]=s.useState(!1);return e.jsxs("div",{className:`address-edit-card ${u?"":"bg-gray-50"} ${u?"":"hover:bg-gray-100"} mb-2 relative`,style:{minHeight:u?340:void 0,paddingBottom:u?0:void 0},children:[e.jsxs("label",{className:"peer-disabled:cursor-not-allowed peer-disabled:opacity-70 text-sm font-semibold text-gray-700 p-0 m-0 leading-none flex items-center mb-1",children:[e.jsx(w,{className:"h-4 w-4 mr-2 text-blue-500"}),"Votre adresse"]}),c&&!u&&e.jsx(n,{variant:"ghost",size:"sm",onClick:()=>{t((e=>({...e,[m]:!e[m]})))},className:"absolute top-4 right-4 text-blue-600 hover:text-blue-700 hover:bg-blue-50 transition-colors",children:e.jsx(K,{className:"h-4 w-4"})}),e.jsx("div",{className:"mt-2",children:u?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"mb-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"address-search",ref:D,value:p,onChange:e=>{x(e.target.value),P(null)},onFocus:()=>{M(!0)},onBlur:()=>{setTimeout((()=>M(!1)),200)},placeholder:"Rechercher une adresse...",className:"address-input w-full pl-10",autoComplete:"off"}),e.jsx(v,{className:"address-input-icon h-5 w-5",style:{top:"50%",transform:"translateY(-50%)"}}),N&&e.jsx(q,{className:"absolute right-3 top-1/2 -translate-y-1/2 h-4 w-4 text-blue-500 animate-spin"}),E&&e.jsx("div",{ref:k,className:"address-suggestions",children:e.jsx("ul",{children:f.map(((s,a)=>e.jsxs("li",{className:"address-suggestion-item",style:{animationDelay:40*a+"ms"},onClick:()=>(e=>{i((s=>({...s,address:{name:e.houseNumber?`${e.houseNumber} ${e.street}`:e.street,complement:"",postalCode:{code:e.postcode},city:{name:e.city}}}))),x(e.label),P(e.label),j([]),U(!1)})(s),children:[e.jsx(w,{className:"h-4 w-4 mt-1 text-blue-500 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"address-suggestion-label",children:s.label}),s.context&&e.jsx("div",{className:"address-suggestion-context",children:s.context})]})]},a)))})})]}),p.length>0&&p.length<3&&e.jsx("div",{className:"address-help mt-1",children:"Veuillez saisir au moins 3 caractères pour la recherche"})]}),e.jsxs("div",{className:"address-fields-grid",children:[e.jsx("div",{className:"relative",children:e.jsx("input",{id:"address-line",value:r.address?.name||"",onChange:e=>i((s=>({...s,address:{...s.address,name:e.target.value}}))),placeholder:"Ligne d'adresse",className:"address-input w-full pl-10",required:!0})}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"address-complement",value:r.address?.complement||"",onChange:e=>i((s=>({...s,address:{...s.address,complement:e.target.value}}))),placeholder:"Complément",className:"address-input w-full pl-10"}),e.jsx(le,{className:"address-input-icon h-5 w-5"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"address-postal",value:r.address?.postalCode?.code||"",onChange:e=>i((s=>({...s,address:{...s.address,postalCode:{code:e.target.value}}}))),placeholder:"Code postal",className:"address-input w-full pl-10",required:!0}),e.jsx(b,{className:"address-input-icon h-5 w-5"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{id:"address-city",value:r.address?.city?.name||"",onChange:e=>i((s=>({...s,address:{...s.address,city:{name:e.target.value}}}))),placeholder:"Ville",className:"address-input w-full pl-10",required:!0}),e.jsx(te,{className:"address-input-icon h-5 w-5"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 mt-6 justify-end mb-0",children:[e.jsxs("button",{type:"button",onClick:async()=>{if(r.address?.name&&r.address?.postalCode?.code&&r.address?.city?.name)try{await o(),t((e=>({...e,[m]:!1}))),x(""),j([]),U(!1)}catch(e){g.error("Une erreur est survenue lors de l'enregistrement de l'adresse"),console.error("Erreur lors de l'enregistrement de l'adresse:",e)}else g.error("Veuillez remplir tous les champs obligatoires")},className:"address-btn-primary",children:[e.jsx("span",{children:"Enregistrer"}),e.jsx("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})]}),e.jsxs("button",{type:"button",onClick:d,className:"address-btn-secondary",children:[e.jsx("svg",{width:"18",height:"18",fill:"none",viewBox:"0 0 24 24",children:e.jsx("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),e.jsx("span",{children:"Annuler"})]})]})]}):e.jsx("div",{className:"flex items-center min-w-0",children:e.jsx("span",{className:"text-sm truncate flex-1 text-gray-900",children:h?B(h):e.jsx("span",{className:"text-gray-500 italic",children:"Aucune adresse renseignée"})})})})]})},me=({userData:a,editedData:r,editMode:l,setEditedData:t,isFieldEditable:i,toggleFieldEdit:o,handleCancelField:d,handleInputChange:n,onSave:c,onSaveAddress:m,setEditMode:u})=>{const{user:h}=y();s.useEffect((()=>{console.log("ContactInfoSection rendered with:",{'isFieldEditable("address")':i("address"),'isFieldEditable("phoneNumber")':i("phoneNumber"),'isFieldEditable("linkedinUrl")':i("linkedinUrl"),"userData?.id":a?.id,"currentUser?.id":h?.id,"currentUser?.roles":h?.roles})}),[a,h,i]);return h?.roles?.some((e=>"ROLE_ADMIN"===e||"ADMIN"===e||"ROLE_SUPER_ADMIN"===e||"SUPER_ADMIN"===e)),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5 sm:gap-6",children:[e.jsx("div",{className:"address-edit-card w-full",children:i("email")?e.jsx($,{field:"email",label:"Email",icon:e.jsx(b,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-300"}),value:a.email,editedValue:r.personal.email,type:"email",isEditing:l.email,isEditable:!0,onEdit:()=>o("email"),onSave:c,onCancel:()=>d("email"),onChange:e=>n("email",e)}):e.jsx(Q,{label:"Email",icon:e.jsx(b,{className:"h-4 w-4 mr-2 text-gray-500 dark:text-gray-300"}),value:a.email||"Non renseigné"})}),e.jsx("div",{className:"address-edit-card w-full",children:i("phoneNumber")?e.jsx($,{field:"phoneNumber",label:"Téléphone",icon:e.jsx(re,{className:"h-4 w-4 mr-2 text-gray-500"}),value:a.phoneNumber,editedValue:r.personal.phoneNumber,type:"phone",isEditing:l.phoneNumber,isEditable:!0,onEdit:()=>o("phoneNumber"),onSave:c,onCancel:()=>d("phoneNumber"),onChange:e=>n("phoneNumber",e)}):e.jsx(Q,{label:"Téléphone",icon:e.jsx(re,{className:"h-4 w-4 mr-2 text-gray-500"}),value:a.phoneNumber||"Non renseigné"})}),e.jsx("div",{className:"address-edit-card w-full",children:i("address")?e.jsx(ce,{userData:a,editedData:r,editMode:l,setEditMode:u,setEditedData:t,onSaveAddress:m,handleCancelAddress:()=>{const e=a.addresses&&a.addresses.length>0?a.addresses[0]:null;t((s=>({...s,address:e?{name:e.name||"",complement:e.complement||"",postalCode:{code:e.postalCode?.code||""},city:{name:e.city?.name||""}}:{name:"",complement:"",postalCode:{code:""},city:{name:""}}}))),u((e=>({...e,address:!1})))},isEditable:!0}):e.jsx(Q,{label:"Adresse",icon:e.jsx(w,{className:"h-4 w-4 mr-2 text-blue-500 flex-shrink-0"}),value:a.addresses&&Array.isArray(a.addresses)&&a.addresses.length>0?B(a.addresses[0]):"Aucune adresse renseignée"})})]})},ue=({userData:a,studentProfile:r,editedData:l,editMode:t,isStudent:i,isAdmin:o,toggleFieldEdit:d,handleCancelField:n,handleInputChange:c,onSave:m})=>{const[u,h]=s.useState(!1),[p,x]=s.useState(""),f=s.useMemo((()=>r?.portfolioUrl||""),[r?.portfolioUrl]);s.useEffect((()=>{x(f)}),[f]),s.useEffect((()=>{const e=e=>{void 0!==e.detail?.portfolioUrl&&(console.log("Mise à jour du portfolio détectée:",e.detail.portfolioUrl),x(e.detail.portfolioUrl))};return window.addEventListener("portfolio-updated",e),()=>{window.removeEventListener("portfolio-updated",e)}}),[]);return s.useEffect((()=>{console.log("ProfessionalInfoSection - studentProfile?.portfolioUrl:",r?.portfolioUrl),console.log("ProfessionalInfoSection - localPortfolioUrl:",p),console.log("ProfessionalInfoSection - editedData.personal.portfolioUrl:",l.personal.portfolioUrl)}),[r?.portfolioUrl,p,l.personal.portfolioUrl]),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-5 sm:gap-6",children:[e.jsx("div",{className:"address-edit-card w-full",children:e.jsx(Q,{label:"Domaine",icon:e.jsx(E,{className:"h-4 w-4 mr-2 text-blue-500"}),value:a.specialization?.domain?.name||"Non renseigné"})}),e.jsx("div",{className:"address-edit-card w-full",children:e.jsx(Q,{label:"Spécialisation",icon:e.jsx(U,{className:"h-4 w-4 mr-2 text-blue-500"}),value:a.specialization?.name||"Non renseignée"})}),e.jsxs("div",{className:"address-edit-card w-full",children:[e.jsx($,{field:"linkedinUrl",label:"LinkedIn",icon:e.jsx(k,{className:"h-4 w-4"}),value:t.linkedinUrl?l.personal.linkedinUrl:a.linkedinUrl||"",editedValue:l.personal.linkedinUrl,type:"text",placeholder:"Lien complet ou identifiant",isEditing:t.linkedinUrl,isEditable:!0,displayAsLink:!0,onEdit:()=>{const e=a.linkedinUrl||"";c("linkedinUrl",e||"https://www.linkedin.com/in/"),d("linkedinUrl")},onSave:()=>{const e=(e=>{if(!e)return"";let s=e.trim();if(/^[a-zA-Z0-9._-]{3,100}$/.test(s))return`https://www.linkedin.com/in/${s}`;const a=s.match(/linkedin\.com\/in\/([a-zA-Z0-9._-]{3,100})/);if(a&&a[1])return`https://www.linkedin.com/in/${a[1]}`;const r=s.match(/\/in\/([a-zA-Z0-9._-]{3,100})/);return r&&r[1]?`https://www.linkedin.com/in/${r[1]}`:/^https?:\/\/(www\.)?linkedin\.com\/in\/[a-zA-Z0-9._-]{3,100}\/?$/.test(s)?s.replace(/\/$/,""):(g.error("Format LinkedIn invalide. Entrez uniquement l'identifiant ou le lien complet."),null)})(l.personal.linkedinUrl);null!==e&&(c("linkedinUrl",e),e!==a.linkedinUrl?m("linkedinUrl",e):d("linkedinUrl"))},onCancel:()=>n("linkedinUrl"),onChange:e=>{t.linkedinUrl&&!a.linkedinUrl&&e.length<28?c("linkedinUrl","https://www.linkedin.com/in/"):c("linkedinUrl",e)}}),t.linkedinUrl&&e.jsx("button",{type:"button",className:"mt-2 text-xs text-red-600 hover:underline ml-2",onClick:()=>{c("linkedinUrl",null),setTimeout((()=>{m("linkedinUrl",null),d("linkedinUrl")}),0)},children:"Supprimer le lien LinkedIn"})]}),i&&e.jsx("div",{className:"address-edit-card w-full",children:e.jsx($,{field:"portfolioUrl",label:"Portfolio",icon:e.jsx(N,{className:"h-4 w-4"}),value:p,editedValue:l.personal.portfolioUrl,type:"url",isEditing:t.portfolioUrl,isEditable:!0,onEdit:()=>{c("portfolioUrl",p),d("portfolioUrl")},onSave:()=>(async e=>{try{if(h(!0),e&&!e.startsWith("https://"))return g.error("L'URL du portfolio doit commencer par https://"),void h(!1);x(e),c("portfolioUrl",e);const s=await D.updatePortfolioUrl(e);s&&s.success?(m("portfolioUrl",e),C(e),g.success("Portfolio mis à jour avec succès"),r&&(r.portfolioUrl=e)):(x(f),g.error("Une erreur est survenue lors de la mise à jour du portfolio"))}catch(s){x(f),console.error("Erreur lors de la mise à jour du portfolio:",s),g.error(s.message||"Une erreur est survenue lors de la mise à jour du portfolio")}finally{h(!1)}})(l.personal.portfolioUrl),onCancel:()=>{n("portfolioUrl"),x(f)},onChange:e=>c("portfolioUrl",e),loading:u})}),i&&e.jsx("div",{className:"address-edit-card w-full",children:e.jsx(Q,{label:"Situation actuelle",icon:e.jsx(E,{className:"h-4 w-4 mr-2 text-blue-500"}),value:r?.situationType?.name||"Non renseignée"})})]})},he=({userData:a,editMode:r,setEditMode:l,editedData:t,setEditedData:i,userRole:d,onSave:n,onSaveAddress:c,onUploadIdentity:m,isLoading:u=!1})=>{const{user:h}=y();if(u)return e.jsx(de,{});const{isStudent:p,isAdmin:x,studentProfile:f,isFieldEditable:j,handleInputChange:N,toggleFieldEdit:w,handleCancelField:v}=(({userData:e,userRole:a,editMode:r,setEditMode:l,editedData:t,setEditedData:i,currentUser:o})=>{const d="ROLE_STUDENT"===a,n="ROLE_SUPER_ADMIN"===a||"SUPER_ADMIN"===a||"SUPERADMIN"===a,c=s.useCallback((()=>["ROLE_ADMIN","ROLE_SUPER_ADMIN","ADMIN","SUPER_ADMIN","SUPERADMIN"].includes(a)),[a])(),m="ROLE_GUEST"===a||"GUEST"===a,u=e?.studentProfile||{},h=s.useCallback((s=>{if(n)return!0;if(c)return!0;if("address"===s)return!(!m||e?.id!==o?.id);const a=["phoneNumber","linkedinUrl"];return d&&a.push("portfolioUrl"),a.includes(s)}),[c,d,m,n,e?.id,o?.id]),p=e=>{if(!e)return!0;try{const s=new Date(e);if(isNaN(s.getTime()))return!1;const a=new Date,r=new Date(a);return r.setFullYear(a.getFullYear()-16),s<=r}catch(s){return!1}};return{isStudent:d,isAdmin:c,isSuperAdmin:n,isGuest:m,studentProfile:u,isFieldEditable:h,handleInputChange:(e,s)=>{"birthDate"!==e||p(s)?i((a=>({...a,personal:{...a.personal,[e]:s}}))):g.error("Vous devez avoir au moins 16 ans pour vous inscrire.")},toggleFieldEdit:e=>{l((s=>({...s,[e]:!s[e]})))},handleCancelField:s=>{i((a=>({...a,personal:{...a.personal,[s]:"portfolioUrl"===s?u?.portfolioUrl??"":e[s]??""}}))),l((e=>({...e,[s]:!1})))},handleCancelAddress:()=>{const s=e.addresses&&e.addresses.length>0?e.addresses[0]:null;i((e=>({...e,address:s?{name:s.name||"",complement:s.complement||"",postalCode:{code:s.postalCode?.code||""},city:{name:s.city?.name||""}}:{name:"",complement:"",postalCode:{code:""},city:{name:""}}}))),l((e=>({...e,address:!1})))},validateMinimumAge:p}})({userData:a,userRole:d,editMode:r,setEditMode:l,editedData:t,setEditedData:i,currentUser:h});return s.useEffect((()=>{if(a){const e={firstName:a.firstName??"",lastName:a.lastName??"",email:a.email??"",phoneNumber:a.phoneNumber??"",linkedinUrl:a.linkedinUrl??"",portfolioUrl:f?.portfolioUrl??""},s=a.addresses&&a.addresses.length>0?a.addresses[0]:null;r.address?i((s=>({...s,personal:e}))):i((a=>({...a,personal:e,address:s?{name:s.name||"",complement:s.complement||"",postalCode:{code:s.postalCode?.code||""},city:{name:s.city?.name||""}}:{name:"",complement:"",postalCode:{code:""},city:{name:""}}})))}}),[a?.id,f?.portfolioUrl]),s.useEffect((()=>{const e=e=>{const s=e.detail?.portfolioUrl;void 0!==s&&(console.log("Mise à jour du portfolio détectée:",s),i((e=>({...e,personal:{...e.personal,portfolioUrl:s}}))),f&&(f.portfolioUrl=s))};return window.addEventListener("portfolio-updated",e),()=>{window.removeEventListener("portfolio-updated",e)}}),[f,i]),e.jsxs("div",{className:"space-y-6 sm:space-y-8 w-full px-1 sm:px-2 md:px-4",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold flex items-center mb-3 sm:mb-5 text-gray-800 dark:text-gray-100",children:[e.jsx(o,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-1.5 sm:mr-2 text-blue-600 dark:text-[#78b9dd]"}),e.jsxs("span",{className:"relative",children:["Informations personnelles",e.jsx("span",{className:"absolute -bottom-1 left-0 w-full h-0.5 bg-blue-600 dark:bg-[#78b9dd]"})]})]}),e.jsx(ne,{userData:a,editedData:t,editMode:r,isFieldEditable:j,toggleFieldEdit:w,handleCancelField:v,handleInputChange:N,onSave:n})]}),e.jsx(G,{className:"my-6 sm:my-8 bg-gray-200 dark:bg-gray-700"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold flex items-center mb-3 sm:mb-5 text-gray-800 dark:text-gray-100",children:[e.jsx(re,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-1.5 sm:mr-2 text-blue-600 dark:text-[#78b9dd]"}),e.jsxs("span",{className:"relative",children:["Coordonnées",e.jsx("span",{className:"absolute -bottom-1 left-0 w-full h-0.5 bg-blue-600 dark:bg-[#78b9dd]"})]})]}),e.jsx(me,{userData:a,editedData:t,editMode:r,setEditedData:i,isFieldEditable:j,toggleFieldEdit:w,handleCancelField:v,handleInputChange:N,onSave:n,onSaveAddress:c,setEditMode:l})]}),e.jsx(G,{className:"my-6 sm:my-8 bg-gray-200 dark:bg-gray-700"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-base sm:text-lg font-semibold flex items-center mb-3 sm:mb-5 text-gray-800 dark:text-gray-100",children:[e.jsx(E,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-1.5 sm:mr-2 text-blue-600 dark:text-[#78b9dd]"}),e.jsxs("span",{className:"relative",children:["Ma carrière",e.jsx("span",{className:"absolute -bottom-1 left-0 w-full h-0.5 bg-blue-600 dark:bg-[#78b9dd]"})]})]}),e.jsx(ue,{userData:a,studentProfile:f,editedData:t,editMode:r,isStudent:p,isAdmin:x,toggleFieldEdit:w,handleCancelField:v,handleInputChange:N,onSave:n})]})]})},pe=()=>{const r=_(),[l,t]=s.useState({personal:!1,address:!1,academic:!1}),[i,o]=s.useState({personal:{firstName:"",lastName:"",email:"",phoneNumber:"",linkedinUrl:"",portfolioUrl:"",nationality:"",birthDate:""},address:{},academic:{}}),{user:d,isLoading:c,isError:m,error:u,forceRefresh:h}=P({refetchOnWindowFocus:!0,refetchOnMount:!0,staleTime:0,cacheTime:3e5,onError:e=>{g.error("Failed to load profile data: "+(e.message||"Unknown error"))}}),p=a.useMemo((()=>d?{data:{user:d,addresses:d.addresses||[],studentProfile:d.studentProfile||null}}:null),[d]),{userRole:x,isStudent:f}=a.useMemo((()=>{const e=d?.roles||[],s=Array.isArray(e)?e:"object"==typeof e?Object.values(e):[],a=s.some((e=>"string"==typeof e&&e.includes("STUDENT")))||d?.studentProfile&&Object.keys(d?.studentProfile||{}).length>0;let r="";if(a)r="ROLE_STUDENT";else if(s.length>0){const e=s[0];r="object"==typeof e&&null!==e&&e.name?e.name:String(e)}return{userRole:r,isStudent:a}}),[d?.roles,d?.studentProfile]);s.useEffect((()=>{if(!Object.values(l).some(Boolean)&&d&&Object.keys(d).length>0){const e={firstName:d.firstName??"",lastName:d.lastName??"",email:d.email??"",phoneNumber:d.phoneNumber??"",linkedinUrl:d.linkedinUrl??"",portfolioUrl:d.studentProfile?.portfolioUrl??"",nationality:d.nationality??"",birthDate:d.birthDate??""};JSON.stringify(e)!==JSON.stringify(i.personal)&&o((s=>({...s,personal:e,address:{},academic:{}})))}}),[p,l]),s.useEffect((()=>{const e=e=>{if(void 0!==e.detail?.portfolioUrl){const s=e.detail.portfolioUrl;i.personal.portfolioUrl!==s&&o((e=>({...e,personal:{...e.personal,portfolioUrl:s}})))}};return window.addEventListener("portfolio-url-updated",e),()=>{window.removeEventListener("portfolio-url-updated",e)}}),[i.personal.portfolioUrl]);const j=s.useCallback(((e,s)=>{"portfolioUrl"===e?(o((e=>({...e,personal:{...e.personal,portfolioUrl:s}}))),d&&d.studentProfile&&(d.studentProfile={...d.studentProfile,portfolioUrl:s},window.dispatchEvent(new CustomEvent("portfolio-update-local",{detail:{portfolioUrl:s}})))):(o((a=>({...a,personal:{...a.personal,[e]:s}}))),d&&(d[e]=s,"birthDate"===e&&s&&(d.age=(e=>{if(!e)return null;try{const s=new Date(e);if(isNaN(s.getTime()))return null;const a=new Date,r=a.getFullYear()-s.getFullYear();return a.getMonth()>s.getMonth()||a.getMonth()===s.getMonth()&&a.getDate()>=s.getDate()?r:r-1}catch(s){return null}})(s))))}),[d]),N=async e=>{try{const s=i.personal[e];if("linkedinUrl"===e&&console.log(`handleSavePersonal - linkedinUrl value: ${JSON.stringify(s)}`),"birthDate"===e&&s){const e=new Date(s),a=new Date,r=new Date(a);if(r.setFullYear(a.getFullYear()-16),e>r)return void g.error("Vous devez avoir au moins 16 ans pour vous inscrire.")}if("email"===e&&s&&!Y(s))return void g.error("Format d'email invalide");if("phoneNumber"===e&&s&&!J(s))return void g.error("Format de numéro de téléphone invalide");if(("firstName"===e||"lastName"===e)&&s&&!H(s))return void g.error(`Format de ${"firstName"===e?"prénom":"nom"} invalide. Utilisez uniquement des lettres, espaces, tirets et apostrophes.`);if("linkedinUrl"===e&&s&&!Z(s))return void g.error("L'URL LinkedIn doit commencer par 'https://www.linkedin.com/in/'");if("linkedinUrl"!==e||null!==s&&""!==s||console.log("Deleting LinkedIn URL"),"portfolioUrl"===e&&s&&!X(s))return void g.error("L'URL du portfolio doit commencer par 'https://'");await R.updateProfile({[e]:s}),j(e,s),t((s=>({...s,[e]:!1}))),document.dispatchEvent(new CustomEvent("user:data-updated")),g.success(`${e} mis à jour avec succès`)}catch(s){"portfolioUrl"===e&&f?(j("portfolioUrl",p?.data?.studentProfile?.portfolioUrl||null),g.error("Erreur lors de la mise à jour de l'URL du portfolio")):(j(e,p?.data?.user?.[e]||null),g.error(`Erreur lors de la mise à jour de ${e}`))}},{mutate:w}=S("/api/profile","put","userProfileData",{onMutate:async e=>{await r.cancelQueries({queryKey:["userProfileData"]});return{previousData:r.getQueryData(["userProfileData"])}},onSuccess:(e,s)=>{g.success("Informations mises à jour avec succès")},onError:(e,s,a)=>{r.setQueryData(["userProfileData"],a.previousData),g.error("Une erreur est survenue lors de la mise à jour du profil")},onSettled:()=>{r.invalidateQueries({queryKey:["userProfileData"]})}}),{mutate:v}=S("/api/student/profile/portfolio-url","put","userProfileData",{onMutate:async e=>{await r.cancelQueries({queryKey:["userProfileData"]});return{previousData:r.getQueryData(["userProfileData"])}},onSuccess:async(e,s)=>{g.success("URL du portfolio mise à jour avec succès"),await r.invalidateQueries({queryKey:["unified-user-data"]}),setTimeout((()=>h()),300),window.dispatchEvent(new CustomEvent("portfolio-url-updated",{detail:{portfolioUrl:s.portfolioUrl}}))},onError:(e,s,a)=>{r.setQueryData(["userProfileData"],a.previousData),g.error(e.response?.data?.message||"L'URL du portfolio doit commencer par 'https://'")},onSettled:()=>{r.invalidateQueries({queryKey:["userProfileData"]}),r.invalidateQueries({queryKey:["profile"]}),r.invalidateQueries({queryKey:["unified-user-data"]})}}),[b,y]=s.useState(null),[E,U]=s.useState(0),k=s.useCallback((e=>{console.log("UserProfileSettings - Profile picture change handler disabled to prevent infinite loops")}),[]);return c?e.jsx(xe,{}):m?e.jsx("div",{className:"space-y-6 bg-white p-6 rounded-lg shadow",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-red-600 mb-2",children:"Error Loading Profile"}),e.jsx("p",{className:"text-gray-600 mb-4",children:u?.response?.data?.message||u?.message||"An unexpected error occurred"}),e.jsx(n,{onClick:()=>h(),children:"Try Again"})]})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6 w-full",children:[e.jsx(M,{className:"overflow-hidden w-full",children:e.jsx("div",{className:"flex flex-col xs:flex-row items-center p-2 xs:p-3",children:e.jsx(oe,{userData:d,onProfilePictureChange:k,isLoading:c})})}),e.jsxs(M,{className:"overflow-hidden w-full",children:[e.jsxs(L,{className:"px-4 sm:px-6 md:px-8 py-3 sm:py-4",children:[e.jsx(A,{className:"text-lg sm:text-xl",children:"Informations personnelles"}),e.jsx(F,{className:"text-xs sm:text-sm",children:"Mettre à jour vos informations personnelles"})]}),e.jsx(I,{className:"px-3 sm:px-4 md:px-6 pb-6",children:e.jsx(he,{userData:d,editMode:l,setEditMode:t,editedData:i,setEditedData:o,userRole:x,onSave:N,onSaveAddress:async()=>{try{const e=i.address,s={name:e.name?.trim()||"",complement:e.complement?.trim()||null,postalCode:{code:e.postalCode?.code?.trim()||""},city:{name:e.city?.name?.trim()||""}};if(!s.name||!s.postalCode.code||!s.city.name)return void g.error("Veuillez remplir tous les champs obligatoires");const a={...s,id:d.addresses?.[0]?.id};await R.updateAddress(a),g.success("Adresse mise à jour avec succès"),await r.invalidateQueries({queryKey:["userProfileData"]}),await h()}catch(e){console.error("Error saving address:",e),g.error("Erreur lors de la mise à jour de l'adresse")}},children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{htmlFor:"nationality",children:"Nationalité"}),e.jsx(se,{id:"nationality",value:i.personal.nationality||"",onChange:e=>N("nationality"),disabled:!l.personal,placeholder:"Votre nationalité"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(ee,{htmlFor:"birthDate",children:"Date de naissance"}),e.jsx(se,{id:"birthDate",type:"date",value:i.personal.birthDate||"",onChange:e=>N("birthDate"),disabled:!l.personal})]})]})})})]})]})},xe=()=>e.jsxs("div",{className:"space-y-4 sm:space-y-6 w-full",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden w-full",children:[e.jsxs("div",{className:"px-4 sm:px-6 md:px-8 py-4 sm:py-5 border-b",children:[e.jsx(f,{className:"h-5 sm:h-6 w-36 sm:w-48 mb-2"}),e.jsx(f,{className:"h-3 sm:h-4 w-48 sm:w-64"})]}),e.jsxs("div",{className:"px-4 sm:px-6 md:px-8 py-4 sm:py-6",children:[e.jsxs("div",{className:"flex flex-col xs:flex-row items-center justify-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{className:"h-20 w-20 sm:h-24 sm:w-24 md:h-32 md:w-32 rounded-full"}),e.jsx(f,{className:"absolute bottom-0 right-0 w-6 sm:w-8 h-6 sm:h-8 rounded-full"})]}),e.jsxs("div",{className:"mt-3 xs:mt-0 xs:ml-3",children:[e.jsx(f,{className:"h-4 sm:h-5 w-32 mb-2"}),e.jsx(f,{className:"h-3 w-40"})]})]}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx(f,{className:"h-8 sm:h-9 w-24 sm:w-28"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden w-full",children:[e.jsxs("div",{className:"px-4 sm:px-6 md:px-8 py-4 sm:py-5 border-b",children:[e.jsx(f,{className:"h-5 sm:h-6 w-48 sm:w-64 mb-2"}),e.jsx(f,{className:"h-3 sm:h-4 w-56 sm:w-80"})]}),e.jsx("div",{className:"px-4 sm:px-6 md:px-8 py-4 sm:py-6",children:e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"h-4 sm:h-5 w-24 sm:w-32"}),e.jsx(f,{className:"h-9 sm:h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"h-4 sm:h-5 w-24 sm:w-32"}),e.jsx(f,{className:"h-9 sm:h-10 w-full"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"h-4 sm:h-5 w-24 sm:w-32"}),e.jsx(f,{className:"h-9 sm:h-10 w-full"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"h-4 sm:h-5 w-24 sm:w-32"}),e.jsx(f,{className:"h-9 sm:h-10 w-full"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{className:"h-4 sm:h-5 w-24 sm:w-32"}),e.jsx(f,{className:"h-9 sm:h-10 w-full"})]}),e.jsxs("div",{className:"pt-3 sm:pt-4",children:[e.jsx(f,{className:"h-5 sm:h-6 w-24 sm:w-32 mb-3 sm:mb-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(f,{className:"h-9 sm:h-10 w-full"}),e.jsx(f,{className:"h-9 sm:h-10 w-full"})]})]}),e.jsx("div",{className:"flex justify-end mt-4 sm:mt-6",children:e.jsx(f,{className:"h-9 sm:h-10 w-32 sm:w-48"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden w-full",children:[e.jsxs("div",{className:"px-4 sm:px-6 md:px-8 py-4 sm:py-5 border-b",children:[e.jsx(f,{className:"h-5 sm:h-6 w-36 sm:w-48 mb-2"}),e.jsx(f,{className:"h-3 sm:h-4 w-48 sm:w-64"})]}),e.jsx("div",{className:"px-4 sm:px-6 md:px-8 py-4 sm:py-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6",children:[e.jsx(f,{className:"h-9 sm:h-10 w-full"}),e.jsx(f,{className:"h-9 sm:h-10 w-full"})]})})]})]}),fe=()=>{const{loadUserData:a}=y();return s.useEffect((()=>{(async()=>{try{T.invalidateQueries({queryKey:["user"]}),T.invalidateQueries({queryKey:["profile"]}),T.invalidateQueries({queryKey:["userProfileData"]}),T.invalidateQueries({queryKey:["unified-user-data"]}),await a(),document.dispatchEvent(new CustomEvent("user:data-updated",{detail:{user:O.getUser()}}))}catch(e){console.error("Error refreshing user data:",e)}})()}),[a]),e.jsxs("div",{className:"w-full max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Mon compte"}),e.jsx(pe,{})]})};export{fe as default};
