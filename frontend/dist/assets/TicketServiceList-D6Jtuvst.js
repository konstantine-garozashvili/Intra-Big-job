import{j as e}from"./ui-DiOaG2iA.js";import{r}from"./router-D7BdrHDj.js";import{ah as t,t as s}from"./index-S9UQtd13.js";import"./react-0RZ2pslC.js";import"./query-D8UIi9X6.js";import"./charts-DkICKEBk.js";function a(){const[a,i]=r.useState([]),[o,c]=r.useState(!0),[d,n]=r.useState(null),[l,u]=r.useState(!1),[x,m]=r.useState(null),[p,h]=r.useState(""),[g,y]=r.useState(""),[b,v]=r.useState(!1);r.useEffect((()=>{f()}),[]);const f=async()=>{try{const e=localStorage.getItem("token");if(!e)return n("Authentication required"),void c(!1);const r=await t.get("/api/ticket-services",{headers:{Authorization:`Bearer ${e}`}});i(r.data),c(!1)}catch(e){console.error("Error fetching services:",e),n("Failed to load services"),s.error("Failed to load services"),c(!1)}};return o?e.jsx("div",{className:"flex justify-center items-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):d?e.jsx("div",{className:"p-6 bg-red-100 border border-red-400 text-red-700 rounded-lg",children:e.jsx("p",{children:d})}):e.jsxs("div",{className:"container mx-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Gestion des services de support"}),!l&&e.jsx("button",{onClick:()=>{u(!0),m(null),h(""),y("")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500",children:"Ajouter un service"})]}),l&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:x?"Modifier le service":"Ajouter un service"}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),p.trim()){v(!0);try{const e=localStorage.getItem("token");if(!e)return void s.error("Authentication required");const r={name:p.trim(),description:g.trim()||null};let a;x?(a=await t.put(`/api/ticket-services/${x}`,r,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),s.success("Service mis à jour avec succès")):(a=await t.post("/api/ticket-services",r,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`}}),s.success("Service créé avec succès")),u(!1),m(null),h(""),y(""),f()}catch(r){console.error("Error saving service:",r),s.error(r.response?.data?.message||"Échec de l'opération")}finally{v(!1)}}else s.error("Le nom du service est requis")},className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Nom *"}),e.jsx("input",{id:"name",type:"text",value:p,onChange:e=>h(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Ex: Support technique, Facturation, etc.",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Description"}),e.jsx("textarea",{id:"description",value:g,onChange:e=>y(e.target.value),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:border-gray-600 dark:text-white",placeholder:"Description du service (optionnel)"})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:()=>{u(!1),m(null),h(""),y("")},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 dark:border-gray-600 dark:text-gray-300 dark:hover:bg-gray-700",children:"Annuler"}),e.jsx("button",{type:"submit",disabled:b,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:b?"Enregistrement...":"Enregistrer"})]})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300",children:"ID"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300",children:"Nom"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300",children:"Description"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider dark:text-gray-300",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200 dark:bg-gray-800 dark:divide-gray-700",children:0===a.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500 dark:text-gray-400",children:"Aucun service n'a été ajouté"})}):a.map((r=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:r.id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white",children:r.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 dark:text-gray-400",children:r.description||"-"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>(e=>{u(!0),m(e.id),h(e.name),y(e.description||"")})(r),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300 mr-4",children:"Modifier"}),e.jsx("button",{onClick:()=>(async e=>{if(window.confirm("Êtes-vous sûr de vouloir supprimer ce service ?"))try{const r=localStorage.getItem("token");if(!r)return void s.error("Authentication required");await t.delete(`/api/ticket-services/${e}`,{headers:{Authorization:`Bearer ${r}`}}),s.success("Service supprimé avec succès"),f()}catch(r){console.error("Error deleting service:",r),s.error(r.response?.data?.message||"Échec de la suppression")}})(r.id),className:"text-red-600 hover:text-red-900 dark:text-red-400 dark:hover:text-red-300",children:"Supprimer"})]})]},r.id)))})]})})})]})}export{a as default};
